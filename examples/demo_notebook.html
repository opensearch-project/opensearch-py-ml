

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Demo Notebook for Dataframe &mdash; Opensearch-py-ml 1.0.0b1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Step 0: Imports" href="online_retail_analysis.html" />
    <link rel="prev" title="Examples" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Opensearch-py-ml
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0b1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#demo-notebooks-for-data-exploration-panda-like-dataframe">Demo notebooks for Data Exploration Panda like DataFrame</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Demo Notebook for Dataframe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#download-notebook">download notebook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Boolean-indexing-query">Boolean indexing query</a></li>
<li class="toctree-l4"><a class="reference internal" href="#max">max</a></li>
<li class="toctree-l4"><a class="reference internal" href="#min">min</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mean">mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sum">sum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="online_retail_analysis.html">Step 0: Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="online_retail_analysis.html#Step-1:-Setup-clients">Step 1: Setup clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="online_retail_analysis.html#Getting-Started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="online_retail_analysis.html#Selecting-and-Indexing-Data">Selecting and Indexing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="online_retail_analysis.html#Aggregation-and-Descriptive-Statistics">Aggregation and Descriptive Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="online_retail_analysis.html#Arithmetic-Operations">Arithmetic Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#demo-notebooks-for-model-training-and-tracing">Demo notebooks for Model Training and Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#demo-notebooks-for-ml-commons-plugin-integration">Demo notebooks for ML Commons plugin integration</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Opensearch-py-ml</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples</a> &raquo;</li>
        
      <li>Demo Notebook for Dataframe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/demo_notebook.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Demo-Notebook-for-Dataframe">
<h1>Demo Notebook for Dataframe<a class="headerlink" href="#Demo-Notebook-for-Dataframe" title="Permalink to this heading">¶</a></h1>
<section id="download-notebook">
<h2><a class="reference external" href="https://github.com/opensearch-project/opensearch-py-ml/blob/main/docs/source/examples/demo_notebook.ipynb">download notebook</a><a class="headerlink" href="#download-notebook" title="Permalink to this heading">¶</a></h2>
<section id="Step-0:-Imports">
<h3>Step 0: Imports<a class="headerlink" href="#Step-0:-Imports" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import this to stop opensearch-py-ml from yelling every time a DataFrame connection made</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports to demonstrate DataFrame support</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">opensearch_py_ml</span> <span class="k">as</span> <span class="nn">oml</span>
<span class="kn">from</span> <span class="nn">opensearchpy</span> <span class="kn">import</span> <span class="n">OpenSearch</span>

<span class="c1"># Import standard test settings for consistent results</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.conftest</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-1:-Setup-clients">
<h3>Step 1: Setup clients<a class="headerlink" href="#Step-1:-Setup-clients" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CLUSTER_URL</span> <span class="o">=</span> <span class="s1">&#39;https://localhost:9200&#39;</span>

<span class="k">def</span> <span class="nf">get_os_client</span><span class="p">(</span><span class="n">cluster_url</span> <span class="o">=</span> <span class="n">CLUSTER_URL</span><span class="p">,</span>
                  <span class="n">username</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span>
                  <span class="n">password</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get OpenSearch client</span>
<span class="sd">    :param cluster_url: cluster URL like https://ml-te-netwo-1s12ba42br23v-ff1736fa7db98ff2.elb.us-west-2.amazonaws.com:443</span>
<span class="sd">    :return: OpenSearch client</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">OpenSearch</span><span class="p">(</span>
        <span class="n">hosts</span><span class="o">=</span><span class="p">[</span><span class="n">cluster_url</span><span class="p">],</span>
        <span class="n">http_auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">),</span>
        <span class="n">verify_certs</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">get_os_client</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Comparing-similarities-and-differences-between-panda-dataframe-vs-opensearch_py_ml-dataframe">
<h3>Comparing similarities and differences between panda dataframe vs opensearch_py_ml dataframe<a class="headerlink" href="#Comparing-similarities-and-differences-between-panda-dataframe-vs-opensearch_py_ml-dataframe" title="Permalink to this heading">¶</a></h3>
<p>Create an opensearch_py_ml.DataFrame from a <code class="docutils literal notranslate"><span class="pre">flights</span></code> index</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span> <span class="o">=</span> <span class="n">oml</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;flights&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">oml_flights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
opensearch_py_ml.dataframe.DataFrame
</pre></div></div>
</div>
<p>Compare to pandas DataFrame (created from the same data)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span> <span class="o">=</span> <span class="n">oml</span><span class="o">.</span><span class="n">opensearch_to_pandas</span><span class="p">(</span><span class="n">oml_flights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">pd_flights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pandas.core.frame.DataFrame
</pre></div></div>
</div>
</section>
<section id="Attributes-and-underlying-data">
<h3>Attributes and underlying data<a class="headerlink" href="#Attributes-and-underlying-data" title="Permalink to this heading">¶</a></h3>
<section id="DataFrame.columns">
<h4>DataFrame.columns<a class="headerlink" href="#DataFrame.columns" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;, &#39;Carrier&#39;, &#39;Dest&#39;, &#39;DestAirportID&#39;, &#39;DestCityName&#39;,
       &#39;DestCountry&#39;, &#39;DestLocation&#39;, &#39;DestRegion&#39;, &#39;DestWeather&#39;, &#39;DistanceKilometers&#39;,
       &#39;DistanceMiles&#39;, &#39;FlightDelay&#39;, &#39;FlightDelayMin&#39;, &#39;FlightDelayType&#39;, &#39;FlightNum&#39;,
       &#39;FlightTimeHour&#39;, &#39;FlightTimeMin&#39;, &#39;Origin&#39;, &#39;OriginAirportID&#39;, &#39;OriginCityName&#39;,
       &#39;OriginCountry&#39;, &#39;OriginLocation&#39;, &#39;OriginRegion&#39;, &#39;OriginWeather&#39;, &#39;dayOfWeek&#39;,
       &#39;timestamp&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;, &#39;Carrier&#39;, &#39;Dest&#39;, &#39;DestAirportID&#39;, &#39;DestCityName&#39;,
       &#39;DestCountry&#39;, &#39;DestLocation&#39;, &#39;DestRegion&#39;, &#39;DestWeather&#39;, &#39;DistanceKilometers&#39;,
       &#39;DistanceMiles&#39;, &#39;FlightDelay&#39;, &#39;FlightDelayMin&#39;, &#39;FlightDelayType&#39;, &#39;FlightNum&#39;,
       &#39;FlightTimeHour&#39;, &#39;FlightTimeMin&#39;, &#39;Origin&#39;, &#39;OriginAirportID&#39;, &#39;OriginCityName&#39;,
       &#39;OriginCountry&#39;, &#39;OriginLocation&#39;, &#39;OriginRegion&#39;, &#39;OriginWeather&#39;, &#39;dayOfWeek&#39;,
       &#39;timestamp&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
</section>
<section id="DataFrame.dtypes">
<h4>DataFrame.dtypes<a class="headerlink" href="#DataFrame.dtypes" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice           float64
Cancelled                   bool
Carrier                   object
Dest                      object
DestAirportID             object
                       ...
OriginLocation            object
OriginRegion              object
OriginWeather             object
dayOfWeek                  int64
timestamp         datetime64[ns]
Length: 27, dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice           float64
Cancelled                   bool
Carrier                   object
Dest                      object
DestAirportID             object
                       ...
OriginLocation            object
OriginRegion              object
OriginWeather             object
dayOfWeek                  int64
timestamp         datetime64[ns]
Length: 27, dtype: object
</pre></div></div>
</div>
</section>
<section id="DataFrame.select_dtypes">
<h4>DataFrame.select_dtypes<a class="headerlink" href="#DataFrame.select_dtypes" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>DistanceKilometers</th>
      <th>...</th>
      <th>FlightTimeMin</th>
      <th>dayOfWeek</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>841.265642</td>
      <td>16492.326654</td>
      <td>...</td>
      <td>1030.770416</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>882.982662</td>
      <td>8823.400140</td>
      <td>...</td>
      <td>464.389481</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>190.636904</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>181.694216</td>
      <td>555.737767</td>
      <td>...</td>
      <td>222.749059</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>730.041778</td>
      <td>13358.244200</td>
      <td>...</td>
      <td>785.779071</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13054</th>
      <td>1080.446279</td>
      <td>8058.581753</td>
      <td>...</td>
      <td>402.929088</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>646.612941</td>
      <td>7088.598322</td>
      <td>...</td>
      <td>644.418029</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>997.751876</td>
      <td>10920.652972</td>
      <td>...</td>
      <td>937.540811</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>1102.814465</td>
      <td>18748.859647</td>
      <td>...</td>
      <td>1697.404971</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>858.144337</td>
      <td>16809.141923</td>
      <td>...</td>
      <td>1610.761827</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>13059 rows × 7 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>DistanceKilometers</th>
      <th>...</th>
      <th>FlightTimeMin</th>
      <th>dayOfWeek</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>841.265642</td>
      <td>16492.326654</td>
      <td>...</td>
      <td>1030.770416</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>882.982662</td>
      <td>8823.400140</td>
      <td>...</td>
      <td>464.389481</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>190.636904</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>181.694216</td>
      <td>555.737767</td>
      <td>...</td>
      <td>222.749059</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>730.041778</td>
      <td>13358.244200</td>
      <td>...</td>
      <td>785.779071</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13054</th>
      <td>1080.446279</td>
      <td>8058.581753</td>
      <td>...</td>
      <td>402.929088</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>646.612941</td>
      <td>7088.598322</td>
      <td>...</td>
      <td>644.418029</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>997.751876</td>
      <td>10920.652972</td>
      <td>...</td>
      <td>937.540811</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>1102.814465</td>
      <td>18748.859647</td>
      <td>...</td>
      <td>1697.404971</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>858.144337</td>
      <td>16809.141923</td>
      <td>...</td>
      <td>1610.761827</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<p>13059 rows × 7 columns</p></div>
</div>
</section>
<section id="DataFrame.empty">
<h4>DataFrame.empty<a class="headerlink" href="#DataFrame.empty" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">empty</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">empty</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
</section>
<section id="DataFrame.shape">
<h4>DataFrame.shape<a class="headerlink" href="#DataFrame.shape" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(13059, 27)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(13059, 27)
</pre></div></div>
</div>
</section>
<section id="DataFrame.index">
<h4>DataFrame.index<a class="headerlink" href="#DataFrame.index" title="Permalink to this heading">¶</a></h4>
<p>Note, <code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.index</span></code> does not mirror <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.index</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;,
       ...
       &#39;13049&#39;, &#39;13050&#39;, &#39;13051&#39;, &#39;13052&#39;, &#39;13053&#39;, &#39;13054&#39;, &#39;13055&#39;, &#39;13056&#39;, &#39;13057&#39;, &#39;13058&#39;],
      dtype=&#39;object&#39;, length=13059)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_IGNORE_OUTPUT</span>
<span class="n">oml_flights</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;opensearch_py_ml.index.Index at 0x1131744c0&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">os_index_field</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;_id&#39;
</pre></div></div>
</div>
</section>
<section id="DataFrame.values">
<h4>DataFrame.values<a class="headerlink" href="#DataFrame.values" title="Permalink to this heading">¶</a></h4>
<p>Note, <code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.values</span></code> is not supported.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[841.2656419677076, False, &#39;Kibana Airlines&#39;, ..., &#39;Sunny&#39;, 0,
        Timestamp(&#39;2018-01-01 00:00:00&#39;)],
       [882.9826615595518, False, &#39;Logstash Airways&#39;, ..., &#39;Clear&#39;, 0,
        Timestamp(&#39;2018-01-01 18:27:00&#39;)],
       [190.6369038508356, False, &#39;Logstash Airways&#39;, ..., &#39;Rain&#39;, 0,
        Timestamp(&#39;2018-01-01 17:11:14&#39;)],
       ...,
       [997.7518761454494, False, &#39;Logstash Airways&#39;, ..., &#39;Sunny&#39;, 6,
        Timestamp(&#39;2018-02-11 04:09:27&#39;)],
       [1102.8144645388556, False, &#39;JetBeats&#39;, ..., &#39;Hail&#39;, 6,
        Timestamp(&#39;2018-02-11 08:28:21&#39;)],
       [858.1443369038839, False, &#39;JetBeats&#39;, ..., &#39;Rain&#39;, 6,
        Timestamp(&#39;2018-02-11 14:54:34&#39;)]], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">oml_flights</span><span class="o">.</span><span class="n">values</span>
<span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
This method would scan/scroll the entire OpenSearch index(s) into memory. If this is explicitly required, and there is sufficient memory, call `ed.opensearch_to_pandas(ed_df).values`
</pre></div></div>
</div>
</section>
</section>
<section id="Indexing,-iteration">
<h3>Indexing, iteration<a class="headerlink" href="#Indexing,-iteration" title="Permalink to this heading">¶</a></h3>
<section id="DataFrame.head">
<h4>DataFrame.head<a class="headerlink" href="#DataFrame.head" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>841.265642</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>882.982662</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 18:27:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>190.636904</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 17:11:14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>181.694216</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 10:33:28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>730.041778</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 05:13:00</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>841.265642</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>882.982662</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 18:27:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>190.636904</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 17:11:14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>181.694216</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 10:33:28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>730.041778</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 05:13:00</td>
    </tr>
  </tbody>
</table>
</div>
<p>5 rows × 27 columns</p></div>
</div>
</section>
<section id="DataFrame.tail">
<h4>DataFrame.tail<a class="headerlink" href="#DataFrame.tail" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13054</th>
      <td>1080.446279</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 20:42:25</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>646.612941</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 01:41:57</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>997.751876</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 04:09:27</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>1102.814465</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 08:28:21</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>858.144337</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 14:54:34</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13054</th>
      <td>1080.446279</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 20:42:25</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>646.612941</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 01:41:57</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>997.751876</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 04:09:27</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>1102.814465</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 08:28:21</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>858.144337</td>
      <td>False</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 14:54:34</td>
    </tr>
  </tbody>
</table>
</div>
<p>5 rows × 27 columns</p></div>
</div>
</section>
<section id="DataFrame.keys">
<h4>DataFrame.keys<a class="headerlink" href="#DataFrame.keys" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;, &#39;Carrier&#39;, &#39;Dest&#39;, &#39;DestAirportID&#39;, &#39;DestCityName&#39;,
       &#39;DestCountry&#39;, &#39;DestLocation&#39;, &#39;DestRegion&#39;, &#39;DestWeather&#39;, &#39;DistanceKilometers&#39;,
       &#39;DistanceMiles&#39;, &#39;FlightDelay&#39;, &#39;FlightDelayMin&#39;, &#39;FlightDelayType&#39;, &#39;FlightNum&#39;,
       &#39;FlightTimeHour&#39;, &#39;FlightTimeMin&#39;, &#39;Origin&#39;, &#39;OriginAirportID&#39;, &#39;OriginCityName&#39;,
       &#39;OriginCountry&#39;, &#39;OriginLocation&#39;, &#39;OriginRegion&#39;, &#39;OriginWeather&#39;, &#39;dayOfWeek&#39;,
       &#39;timestamp&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;, &#39;Carrier&#39;, &#39;Dest&#39;, &#39;DestAirportID&#39;, &#39;DestCityName&#39;,
       &#39;DestCountry&#39;, &#39;DestLocation&#39;, &#39;DestRegion&#39;, &#39;DestWeather&#39;, &#39;DistanceKilometers&#39;,
       &#39;DistanceMiles&#39;, &#39;FlightDelay&#39;, &#39;FlightDelayMin&#39;, &#39;FlightDelayType&#39;, &#39;FlightNum&#39;,
       &#39;FlightTimeHour&#39;, &#39;FlightTimeMin&#39;, &#39;Origin&#39;, &#39;OriginAirportID&#39;, &#39;OriginCityName&#39;,
       &#39;OriginCountry&#39;, &#39;OriginLocation&#39;, &#39;OriginRegion&#39;, &#39;OriginWeather&#39;, &#39;dayOfWeek&#39;,
       &#39;timestamp&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
</section>
<section id="DataFrame.get">
<h4>DataFrame.get<a class="headerlink" href="#DataFrame.get" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Carrier&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0         Kibana Airlines
1        Logstash Airways
2        Logstash Airways
3         Kibana Airlines
4         Kibana Airlines
               ...
13054    Logstash Airways
13055    Logstash Airways
13056    Logstash Airways
13057            JetBeats
13058            JetBeats
Name: Carrier, Length: 13059, dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Carrier&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0         Kibana Airlines
1        Logstash Airways
2        Logstash Airways
3         Kibana Airlines
4         Kibana Airlines
               ...
13054    Logstash Airways
13055    Logstash Airways
13056    Logstash Airways
13057            JetBeats
13058            JetBeats
Name: Carrier, Length: 13059, dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s1">&#39;Carrier&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Carrier</th>
      <th>Origin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kibana Airlines</td>
      <td>Frankfurt am Main Airport</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logstash Airways</td>
      <td>Cape Town International Airport</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Logstash Airways</td>
      <td>Venice Marco Polo Airport</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kibana Airlines</td>
      <td>Naples International Airport</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kibana Airlines</td>
      <td>Licenciado Benito Juarez International Airport</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13054</th>
      <td>Logstash Airways</td>
      <td>Pisa International Airport</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>Logstash Airways</td>
      <td>Winnipeg / James Armstrong Richardson Internat...</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>Logstash Airways</td>
      <td>Licenciado Benito Juarez International Airport</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>JetBeats</td>
      <td>Itami Airport</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>JetBeats</td>
      <td>Adelaide International Airport</td>
    </tr>
  </tbody>
</table>
<p>13059 rows × 2 columns</p>
</div></div>
</div>
<p>List input not currently supported by <code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.get</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">oml_flights</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s1">&#39;Carrier&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
unhashable type: &#39;list&#39;
</pre></div></div>
</div>
</section>
<section id="DataFrame.query">
<h4>DataFrame.query<a class="headerlink" href="#DataFrame.query" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Carrier == &quot;Kibana Airlines&quot; &amp; AvgTicketPrice &gt; 900.0 &amp; Cancelled == True&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>960.869736</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 12:09:35</td>
    </tr>
    <tr>
      <th>26</th>
      <td>975.812632</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 15:38:32</td>
    </tr>
    <tr>
      <th>311</th>
      <td>946.358410</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 11:51:12</td>
    </tr>
    <tr>
      <th>651</th>
      <td>975.383864</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 21:13:17</td>
    </tr>
    <tr>
      <th>950</th>
      <td>907.836523</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 05:14:51</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12820</th>
      <td>909.973606</td>
      <td>True</td>
      <td>...</td>
      <td>5</td>
      <td>2018-02-10 05:11:35</td>
    </tr>
    <tr>
      <th>12906</th>
      <td>983.429244</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 06:19:58</td>
    </tr>
    <tr>
      <th>12918</th>
      <td>1136.678150</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 16:03:10</td>
    </tr>
    <tr>
      <th>12919</th>
      <td>1105.211803</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 05:36:05</td>
    </tr>
    <tr>
      <th>13013</th>
      <td>1055.350213</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 13:20:16</td>
    </tr>
  </tbody>
</table>
<p>68 rows × 27 columns</p>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.query</span></code> requires qualifier on bool i.e.</p>
<p><code class="docutils literal notranslate"><span class="pre">oml_flights.query('Carrier</span> <span class="pre">==</span> <span class="pre">&quot;Kibana</span> <span class="pre">Airlines&quot;</span> <span class="pre">&amp;</span> <span class="pre">AvgTicketPrice</span> <span class="pre">&gt;</span> <span class="pre">900.0</span> <span class="pre">&amp;</span> <span class="pre">Cancelled')</span></code> fails</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Carrier == &quot;Kibana Airlines&quot; &amp; AvgTicketPrice &gt; 900.0 &amp; Cancelled == True&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>960.869736</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 12:09:35</td>
    </tr>
    <tr>
      <th>26</th>
      <td>975.812632</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 15:38:32</td>
    </tr>
    <tr>
      <th>311</th>
      <td>946.358410</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 11:51:12</td>
    </tr>
    <tr>
      <th>651</th>
      <td>975.383864</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 21:13:17</td>
    </tr>
    <tr>
      <th>950</th>
      <td>907.836523</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 05:14:51</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12820</th>
      <td>909.973606</td>
      <td>True</td>
      <td>...</td>
      <td>5</td>
      <td>2018-02-10 05:11:35</td>
    </tr>
    <tr>
      <th>12906</th>
      <td>983.429244</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 06:19:58</td>
    </tr>
    <tr>
      <th>12918</th>
      <td>1136.678150</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 16:03:10</td>
    </tr>
    <tr>
      <th>12919</th>
      <td>1105.211803</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 05:36:05</td>
    </tr>
    <tr>
      <th>13013</th>
      <td>1055.350213</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 13:20:16</td>
    </tr>
  </tbody>
</table>
</div>
<p>68 rows × 27 columns</p></div>
</div>
</section>
</section>
</section>
<section id="Boolean-indexing-query">
<h2>Boolean indexing query<a class="headerlink" href="#Boolean-indexing-query" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="p">[(</span><span class="n">pd_flights</span><span class="o">.</span><span class="n">Carrier</span><span class="o">==</span><span class="s2">&quot;Kibana Airlines&quot;</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">pd_flights</span><span class="o">.</span><span class="n">AvgTicketPrice</span> <span class="o">&gt;</span> <span class="mf">900.0</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">pd_flights</span><span class="o">.</span><span class="n">Cancelled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>960.869736</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 12:09:35</td>
    </tr>
    <tr>
      <th>26</th>
      <td>975.812632</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 15:38:32</td>
    </tr>
    <tr>
      <th>311</th>
      <td>946.358410</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 11:51:12</td>
    </tr>
    <tr>
      <th>651</th>
      <td>975.383864</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 21:13:17</td>
    </tr>
    <tr>
      <th>950</th>
      <td>907.836523</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 05:14:51</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12820</th>
      <td>909.973606</td>
      <td>True</td>
      <td>...</td>
      <td>5</td>
      <td>2018-02-10 05:11:35</td>
    </tr>
    <tr>
      <th>12906</th>
      <td>983.429244</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 06:19:58</td>
    </tr>
    <tr>
      <th>12918</th>
      <td>1136.678150</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 16:03:10</td>
    </tr>
    <tr>
      <th>12919</th>
      <td>1105.211803</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 05:36:05</td>
    </tr>
    <tr>
      <th>13013</th>
      <td>1055.350213</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 13:20:16</td>
    </tr>
  </tbody>
</table>
<p>68 rows × 27 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="p">[(</span><span class="n">oml_flights</span><span class="o">.</span><span class="n">Carrier</span><span class="o">==</span><span class="s2">&quot;Kibana Airlines&quot;</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">oml_flights</span><span class="o">.</span><span class="n">AvgTicketPrice</span> <span class="o">&gt;</span> <span class="mf">900.0</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">oml_flights</span><span class="o">.</span><span class="n">Cancelled</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>960.869736</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 12:09:35</td>
    </tr>
    <tr>
      <th>26</th>
      <td>975.812632</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 15:38:32</td>
    </tr>
    <tr>
      <th>311</th>
      <td>946.358410</td>
      <td>True</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 11:51:12</td>
    </tr>
    <tr>
      <th>651</th>
      <td>975.383864</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 21:13:17</td>
    </tr>
    <tr>
      <th>950</th>
      <td>907.836523</td>
      <td>True</td>
      <td>...</td>
      <td>2</td>
      <td>2018-01-03 05:14:51</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12820</th>
      <td>909.973606</td>
      <td>True</td>
      <td>...</td>
      <td>5</td>
      <td>2018-02-10 05:11:35</td>
    </tr>
    <tr>
      <th>12906</th>
      <td>983.429244</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 06:19:58</td>
    </tr>
    <tr>
      <th>12918</th>
      <td>1136.678150</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 16:03:10</td>
    </tr>
    <tr>
      <th>12919</th>
      <td>1105.211803</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 05:36:05</td>
    </tr>
    <tr>
      <th>13013</th>
      <td>1055.350213</td>
      <td>True</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 13:20:16</td>
    </tr>
  </tbody>
</table>
</div>
<p>68 rows × 27 columns</p></div>
</div>
<section id="Function-application,-GroupBy-&amp;-window">
<h3>Function application, GroupBy &amp; window<a class="headerlink" href="#Function-application,-GroupBy-&-window" title="Permalink to this heading">¶</a></h3>
<section id="DataFrame.aggs">
<h4>DataFrame.aggs<a class="headerlink" href="#DataFrame.aggs" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="p">[[</span><span class="s1">&#39;DistanceKilometers&#39;</span><span class="p">,</span> <span class="s1">&#39;AvgTicketPrice&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DistanceKilometers</th>
      <th>AvgTicketPrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sum</th>
      <td>9.261629e+07</td>
      <td>8.204365e+06</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>1.000205e+02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.578438e+03</td>
      <td>2.663969e+02</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.aggregate</span></code> currently only supported numeric columns</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="p">[[</span><span class="s1">&#39;DistanceKilometers&#39;</span><span class="p">,</span> <span class="s1">&#39;AvgTicketPrice&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DistanceKilometers</th>
      <th>AvgTicketPrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sum</th>
      <td>9.261629e+07</td>
      <td>8.204365e+06</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>1.000205e+02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>4.578614e+03</td>
      <td>2.664071e+02</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Computations-/-descriptive-stats">
<h3>Computations / descriptive stats<a class="headerlink" href="#Computations-/-descriptive-stats" title="Permalink to this heading">¶</a></h3>
<section id="DataFrame.count">
<h4>DataFrame.count<a class="headerlink" href="#DataFrame.count" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice    13059
Cancelled         13059
Carrier           13059
Dest              13059
DestAirportID     13059
                  ...
OriginLocation    13059
OriginRegion      13059
OriginWeather     13059
dayOfWeek         13059
timestamp         13059
Length: 27, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice    13059
Cancelled         13059
Carrier           13059
Dest              13059
DestAirportID     13059
                  ...
OriginLocation    13059
OriginRegion      13059
OriginWeather     13059
dayOfWeek         13059
timestamp         13059
Length: 27, dtype: int64
</pre></div></div>
</div>
</section>
<section id="DataFrame.describe">
<h4>DataFrame.describe<a class="headerlink" href="#DataFrame.describe" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>DistanceKilometers</th>
      <th>...</th>
      <th>FlightTimeMin</th>
      <th>dayOfWeek</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>13059.000000</td>
      <td>13059.000000</td>
      <td>...</td>
      <td>13059.000000</td>
      <td>13059.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>628.253689</td>
      <td>7092.142455</td>
      <td>...</td>
      <td>511.127842</td>
      <td>2.835975</td>
    </tr>
    <tr>
      <th>std</th>
      <td>266.396861</td>
      <td>4578.438497</td>
      <td>...</td>
      <td>334.753952</td>
      <td>1.939439</td>
    </tr>
    <tr>
      <th>min</th>
      <td>100.020528</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>409.893816</td>
      <td>2459.705673</td>
      <td>...</td>
      <td>252.333192</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>640.556668</td>
      <td>7610.330866</td>
      <td>...</td>
      <td>503.045170</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>842.185470</td>
      <td>9736.637600</td>
      <td>...</td>
      <td>720.416036</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1199.729053</td>
      <td>19881.482315</td>
      <td>...</td>
      <td>1902.902032</td>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 7 columns</p>
</div></div>
</div>
<p>Values returned from <code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.describe</span></code> may vary due to results of Opensearch aggregations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_IGNORE_OUTPUT</span>
<span class="n">oml_flights</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AvgTicketPrice</th>
      <th>Cancelled</th>
      <th>...</th>
      <th>FlightTimeMin</th>
      <th>dayOfWeek</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>13059.000000</td>
      <td>13059.000000</td>
      <td>...</td>
      <td>13059.000000</td>
      <td>13059.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>628.253689</td>
      <td>0.128494</td>
      <td>...</td>
      <td>511.127842</td>
      <td>2.835975</td>
    </tr>
    <tr>
      <th>std</th>
      <td>266.407061</td>
      <td>0.334664</td>
      <td>...</td>
      <td>334.766770</td>
      <td>1.939513</td>
    </tr>
    <tr>
      <th>min</th>
      <td>100.020531</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>410.008918</td>
      <td>0.000000</td>
      <td>...</td>
      <td>251.938710</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>640.387285</td>
      <td>0.000000</td>
      <td>...</td>
      <td>503.148975</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>842.213490</td>
      <td>0.000000</td>
      <td>...</td>
      <td>720.505705</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1199.729004</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1902.901978</td>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 9 columns</p>
</div></div>
</div>
</section>
<section id="DataFrame.info">
<h4>DataFrame.info<a class="headerlink" href="#DataFrame.info" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 13059 entries, 0 to 13058
Data columns (total 27 columns):
 #   Column              Non-Null Count  Dtype
---  ------              --------------  -----
 0   AvgTicketPrice      13059 non-null  float64
 1   Cancelled           13059 non-null  bool
 2   Carrier             13059 non-null  object
 3   Dest                13059 non-null  object
 4   DestAirportID       13059 non-null  object
 5   DestCityName        13059 non-null  object
 6   DestCountry         13059 non-null  object
 7   DestLocation        13059 non-null  object
 8   DestRegion          13059 non-null  object
 9   DestWeather         13059 non-null  object
 10  DistanceKilometers  13059 non-null  float64
 11  DistanceMiles       13059 non-null  float64
 12  FlightDelay         13059 non-null  bool
 13  FlightDelayMin      13059 non-null  int64
 14  FlightDelayType     13059 non-null  object
 15  FlightNum           13059 non-null  object
 16  FlightTimeHour      13059 non-null  float64
 17  FlightTimeMin       13059 non-null  float64
 18  Origin              13059 non-null  object
 19  OriginAirportID     13059 non-null  object
 20  OriginCityName      13059 non-null  object
 21  OriginCountry       13059 non-null  object
 22  OriginLocation      13059 non-null  object
 23  OriginRegion        13059 non-null  object
 24  OriginWeather       13059 non-null  object
 25  dayOfWeek           13059 non-null  int64
 26  timestamp           13059 non-null  datetime64[ns]
dtypes: bool(2), datetime64[ns](1), float64(5), int64(2), object(17)
memory usage: 3.1+ MB
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;opensearch_py_ml.dataframe.DataFrame&#39;&gt;
Index: 13059 entries, 0 to 13058
Data columns (total 27 columns):
 #   Column              Non-Null Count  Dtype
---  ------              --------------  -----
 0   AvgTicketPrice      13059 non-null  float64
 1   Cancelled           13059 non-null  bool
 2   Carrier             13059 non-null  object
 3   Dest                13059 non-null  object
 4   DestAirportID       13059 non-null  object
 5   DestCityName        13059 non-null  object
 6   DestCountry         13059 non-null  object
 7   DestLocation        13059 non-null  object
 8   DestRegion          13059 non-null  object
 9   DestWeather         13059 non-null  object
 10  DistanceKilometers  13059 non-null  float64
 11  DistanceMiles       13059 non-null  float64
 12  FlightDelay         13059 non-null  bool
 13  FlightDelayMin      13059 non-null  int64
 14  FlightDelayType     13059 non-null  object
 15  FlightNum           13059 non-null  object
 16  FlightTimeHour      13059 non-null  float64
 17  FlightTimeMin       13059 non-null  float64
 18  Origin              13059 non-null  object
 19  OriginAirportID     13059 non-null  object
 20  OriginCityName      13059 non-null  object
 21  OriginCountry       13059 non-null  object
 22  OriginLocation      13059 non-null  object
 23  OriginRegion        13059 non-null  object
 24  OriginWeather       13059 non-null  object
 25  dayOfWeek           13059 non-null  int64
 26  timestamp           13059 non-null  datetime64[ns]
dtypes: bool(2), datetime64[ns](1), float64(5), int64(2), object(17)
memory usage: 64.000 bytes
OpenSearch storage usage: 10.714 MB
</pre></div></div>
</div>
</section>
<section id="DataFrame.max,-DataFrame.min,-DataFrame.mean,-DataFrame.sum">
<h4>DataFrame.max, DataFrame.min, DataFrame.mean, DataFrame.sum<a class="headerlink" href="#DataFrame.max,-DataFrame.min,-DataFrame.mean,-DataFrame.sum" title="Permalink to this heading">¶</a></h4>
</section>
</section>
</section>
<section id="max">
<h2>max<a class="headerlink" href="#max" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice         1199.729053
Cancelled                     True
DistanceKilometers    19881.482315
DistanceMiles         12353.780369
FlightDelay                   True
FlightDelayMin                 360
FlightTimeHour           31.715034
FlightTimeMin          1902.902032
dayOfWeek                        6
dtype: object
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">opensearch_py_ml.DataFrame.max,min,mean,sum</span></code> only aggregate numeric columns</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice         1199.729004
Cancelled                 1.000000
DistanceKilometers    19881.482422
DistanceMiles         12353.780273
FlightDelay               1.000000
FlightDelayMin          360.000000
FlightTimeHour           31.715034
FlightTimeMin          1902.901978
dayOfWeek                 6.000000
dtype: float64
</pre></div></div>
</div>
</section>
<section id="min">
<h2>min<a class="headerlink" href="#min" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice        100.020528
Cancelled                  False
DistanceKilometers           0.0
DistanceMiles                0.0
FlightDelay                False
FlightDelayMin                 0
FlightTimeHour               0.0
FlightTimeMin                0.0
dayOfWeek                      0
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice        100.020531
Cancelled               0.000000
DistanceKilometers      0.000000
DistanceMiles           0.000000
FlightDelay             0.000000
FlightDelayMin          0.000000
FlightTimeHour          0.000000
FlightTimeMin           0.000000
dayOfWeek               0.000000
dtype: float64
</pre></div></div>
</div>
</section>
<section id="mean">
<h2>mean<a class="headerlink" href="#mean" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice         628.253689
Cancelled                0.128494
DistanceKilometers    7092.142455
DistanceMiles         4406.853013
FlightDelay              0.251168
FlightDelayMin          47.335171
FlightTimeHour           8.518797
FlightTimeMin          511.127842
dayOfWeek                2.835975
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice         628.253689
Cancelled                0.128494
DistanceKilometers    7092.142457
DistanceMiles         4406.853010
FlightDelay              0.251168
FlightDelayMin          47.335171
FlightTimeHour           8.518797
FlightTimeMin          511.127842
dayOfWeek                2.835975
dtype: float64
</pre></div></div>
</div>
</section>
<section id="sum">
<h2>sum<a class="headerlink" href="#sum" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice        8.204365e+06
Cancelled             1.678000e+03
DistanceKilometers    9.261629e+07
DistanceMiles         5.754909e+07
FlightDelay           3.280000e+03
FlightDelayMin        6.181500e+05
FlightTimeHour        1.112470e+05
FlightTimeMin         6.674818e+06
dayOfWeek             3.703500e+04
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AvgTicketPrice        8.204365e+06
Cancelled             1.678000e+03
DistanceKilometers    9.261629e+07
DistanceMiles         5.754909e+07
FlightDelay           3.280000e+03
FlightDelayMin        6.181500e+05
FlightTimeHour        1.112470e+05
FlightTimeMin         6.674818e+06
dayOfWeek             3.703500e+04
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="p">[[</span><span class="s1">&#39;Carrier&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">,</span> <span class="s1">&#39;Dest&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Carrier      4
Origin     156
Dest       156
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="p">[[</span><span class="s1">&#39;Carrier&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin&#39;</span><span class="p">,</span> <span class="s1">&#39;Dest&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Carrier      4
Origin     156
Dest       156
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AvgTicketPrice&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Cancelled&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestLocation&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Dest&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestAirportID&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestCityName&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestCountry&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Carrier</th>
      <th>DestRegion</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kibana Airlines</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logstash Airways</td>
      <td>IT-34</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 18:27:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Logstash Airways</td>
      <td>IT-34</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 17:11:14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kibana Airlines</td>
      <td>IT-34</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 10:33:28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kibana Airlines</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 05:13:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13054</th>
      <td>Logstash Airways</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 20:42:25</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>Logstash Airways</td>
      <td>CH-ZH</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 01:41:57</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>Logstash Airways</td>
      <td>RU-AMU</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 04:09:27</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>JetBeats</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 08:28:21</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>JetBeats</td>
      <td>US-DC</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 14:54:34</td>
    </tr>
  </tbody>
</table>
<p>13059 rows × 20 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AvgTicketPrice&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Cancelled&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestLocation&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;Dest&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestAirportID&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestCityName&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;DestCountry&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Carrier</th>
      <th>DestRegion</th>
      <th>...</th>
      <th>dayOfWeek</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kibana Airlines</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logstash Airways</td>
      <td>IT-34</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 18:27:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Logstash Airways</td>
      <td>IT-34</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 17:11:14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kibana Airlines</td>
      <td>IT-34</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 10:33:28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kibana Airlines</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>0</td>
      <td>2018-01-01 05:13:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13054</th>
      <td>Logstash Airways</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 20:42:25</td>
    </tr>
    <tr>
      <th>13055</th>
      <td>Logstash Airways</td>
      <td>CH-ZH</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 01:41:57</td>
    </tr>
    <tr>
      <th>13056</th>
      <td>Logstash Airways</td>
      <td>RU-AMU</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 04:09:27</td>
    </tr>
    <tr>
      <th>13057</th>
      <td>JetBeats</td>
      <td>SE-BD</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 08:28:21</td>
    </tr>
    <tr>
      <th>13058</th>
      <td>JetBeats</td>
      <td>US-DC</td>
      <td>...</td>
      <td>6</td>
      <td>2018-02-11 14:54:34</td>
    </tr>
  </tbody>
</table>
</div>
<p>13059 rows × 20 columns</p></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_flights</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_demo_notebook_98_0.png" src="../_images/examples_demo_notebook_98_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_demo_notebook_99_0.png" src="../_images/examples_demo_notebook_99_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oml_flights2</span> <span class="o">=</span> <span class="n">oml_flights</span><span class="p">[(</span><span class="n">oml_flights</span><span class="o">.</span><span class="n">OriginAirportID</span> <span class="o">==</span> <span class="s1">&#39;AMS&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">oml_flights</span><span class="o">.</span><span class="n">FlightDelayMin</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">)]</span>
<span class="n">oml_flights2</span> <span class="o">=</span> <span class="n">oml_flights2</span><span class="p">[[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;OriginAirportID&#39;</span><span class="p">,</span> <span class="s1">&#39;DestAirportID&#39;</span><span class="p">,</span> <span class="s1">&#39;FlightDelayMin&#39;</span><span class="p">]]</span>
<span class="n">oml_flights2</span> <span class="o">=</span> <span class="n">oml_flights2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">oml_flights2</span><span class="o">.</span><span class="n">os_info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
os_index_pattern: flights
Index:
 os_index_field: _id
 is_source_field: False
Mappings:
 capabilities:
                   os_field_name  is_source os_dtype                  os_date_format        pd_dtype  is_searchable  is_aggregatable  is_scripted aggregatable_os_field_name
timestamp              timestamp       True     date  strict_date_hour_minute_second  datetime64[ns]           True             True        False                  timestamp
OriginAirportID  OriginAirportID       True  keyword                            None          object           True             True        False            OriginAirportID
DestAirportID      DestAirportID       True  keyword                            None          object           True             True        False              DestAirportID
FlightDelayMin    FlightDelayMin       True  integer                            None           int64           True             True        False             FlightDelayMin
Operations:
 tasks: [(&#39;boolean_filter&#39;: (&#39;boolean_filter&#39;: {&#39;bool&#39;: {&#39;must&#39;: [{&#39;term&#39;: {&#39;OriginAirportID&#39;: &#39;AMS&#39;}}, {&#39;range&#39;: {&#39;FlightDelayMin&#39;: {&#39;gt&#39;: 60}}}]}})), (&#39;tail&#39;: (&#39;sort_field&#39;: &#39;_doc&#39;, &#39;count&#39;: 5))]
 size: 5
 sort_params: {&#39;_doc&#39;: &#39;desc&#39;}
 _source: [&#39;timestamp&#39;, &#39;OriginAirportID&#39;, &#39;DestAirportID&#39;, &#39;FlightDelayMin&#39;]
 body: {&#39;query&#39;: {&#39;bool&#39;: {&#39;must&#39;: [{&#39;term&#39;: {&#39;OriginAirportID&#39;: &#39;AMS&#39;}}, {&#39;range&#39;: {&#39;FlightDelayMin&#39;: {&#39;gt&#39;: 60}}}]}}}
 post_processing: [(&#39;sort_index&#39;)]

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="online_retail_analysis.html" class="btn btn-neutral float-right" title="Step 0: Imports" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Opensearch.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>