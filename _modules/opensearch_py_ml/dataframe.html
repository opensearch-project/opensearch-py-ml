<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>opensearch_py_ml.dataframe &mdash; Opensearch-py-ml 1.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=fc837d61"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Opensearch-py-ml
          </a>
              <div class="version">
                1.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/pre_trained_models.html">Pre-trained models</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Opensearch-py-ml</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">opensearch_py_ml.dataframe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for opensearch_py_ml.dataframe</h1><div class="highlight"><pre>
<span></span><span class="c1"># SPDX-License-Identifier: Apache-2.0</span>
<span class="c1"># The OpenSearch Contributors require contributions made to</span>
<span class="c1"># this file be licensed under the Apache-2.0 license or a</span>
<span class="c1"># compatible open source license.</span>
<span class="c1"># Any modifications Copyright OpenSearch Contributors. See</span>
<span class="c1"># GitHub history for details.</span>


<span class="c1">#  Licensed to Elasticsearch B.V. under one or more contributor</span>
<span class="c1">#  license agreements. See the NOTICE file distributed with</span>
<span class="c1">#  this work for additional information regarding copyright</span>
<span class="c1">#  ownership. Elasticsearch B.V. licenses this file to you under</span>
<span class="c1">#  the Apache License, Version 2.0 (the &quot;License&quot;); you may</span>
<span class="c1">#  not use this file except in compliance with the License.</span>
<span class="c1">#  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># 	http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1">#  Unless required by applicable law or agreed to in writing,</span>
<span class="c1">#  software distributed under the License is distributed on an</span>
<span class="c1">#  &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span>
<span class="c1">#  KIND, either express or implied.  See the License for the</span>
<span class="c1">#  specific language governing permissions and limitations</span>
<span class="c1">#  under the License.</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.core.common</span> <span class="kn">import</span> <span class="n">apply_if_callable</span><span class="p">,</span> <span class="n">is_bool_indexer</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.core.computation.eval</span> <span class="kn">import</span> <span class="nb">eval</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.core.dtypes.common</span> <span class="kn">import</span> <span class="n">is_list_like</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.core.indexing</span> <span class="kn">import</span> <span class="n">check_bool_indexer</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.io.common</span> <span class="kn">import</span> <span class="n">_expand_user</span><span class="p">,</span> <span class="n">stringify_path</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.io.formats</span> <span class="kn">import</span> <span class="n">console</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.io.formats</span> <span class="kn">import</span> <span class="nb">format</span> <span class="k">as</span> <span class="n">fmt</span>
<span class="kn">from</span> <span class="nn">pandas.io.formats.printing</span> <span class="kn">import</span> <span class="n">pprint_thing</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">pandas.util._validators</span> <span class="kn">import</span> <span class="n">validate_bool_kwarg</span>  <span class="c1"># type: ignore</span>

<span class="kn">import</span> <span class="nn">opensearch_py_ml.plotting</span> <span class="k">as</span> <span class="nn">gfx</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.common</span> <span class="kn">import</span> <span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="p">,</span> <span class="n">docstring_parameter</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.filter</span> <span class="kn">import</span> <span class="n">BooleanFilter</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.groupby</span> <span class="kn">import</span> <span class="n">DataFrameGroupBy</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.ndframe</span> <span class="kn">import</span> <span class="n">NDFrame</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.series</span> <span class="kn">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">opensearch_py_ml.utils</span> <span class="kn">import</span> <span class="n">is_valid_attr_name</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">opensearchpy</span> <span class="kn">import</span> <span class="n">OpenSearch</span>

    <span class="kn">from</span> <span class="nn">.query_compiler</span> <span class="kn">import</span> <span class="n">QueryCompiler</span>


<div class="viewcode-block" id="DataFrame">
<a class="viewcode-back" href="../../reference/api/DataFrame.html#opensearch_py_ml.DataFrame">[docs]</a>
<span class="k">class</span> <span class="nc">DataFrame</span><span class="p">(</span><span class="n">NDFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Two-dimensional size-mutable, potentially heterogeneous tabular data structure with labeled axes</span>
<span class="sd">    (rows and columns) referencing data stored in OpenSearch indices.</span>
<span class="sd">    Where possible APIs mirror pandas.DataFrame APIs.</span>
<span class="sd">    The underlying data is stored in OpenSearch rather than core memory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    os_client: OpenSearch client</span>
<span class="sd">    os_index_pattern: str OpenSearch index pattern. This can contain wildcards. (e.g. &#39;flights&#39;)</span>
<span class="sd">    columns: list of str, optional List of DataFrame columns. A subset of the OpenSearch index&#39;s fields.</span>
<span class="sd">    os_index_field: str, optional The OpenSearch index field to use as the DataFrame index. Defaults to _id if None is used.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :pandas_api_docs:`pandas.DataFrame`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Constructing DataFrame from an OpenSearch configuration arguments and an OpenSearch index</span>

<span class="sd">    &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>


<span class="sd">    &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">    &gt;&gt;&gt; df.head()</span>
<span class="sd">       AvgTicketPrice  Cancelled  ... dayOfWeek           timestamp</span>
<span class="sd">    0      841.265642      False  ...         0 2018-01-01 00:00:00</span>
<span class="sd">    1      882.982662      False  ...         0 2018-01-01 18:27:00</span>
<span class="sd">    2      190.636904      False  ...         0 2018-01-01 17:11:14</span>
<span class="sd">    3      181.694216       True  ...         0 2018-01-01 10:33:28</span>
<span class="sd">    4      730.041778      False  ...         0 2018-01-01 05:13:00</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    [5 rows x 27 columns]</span>


<span class="sd">    Constructing DataFrame from an OpenSearch client and an OpenSearch index</span>

<span class="sd">    &gt;&gt;&gt; df = oml.DataFrame(os_client=OPENSEARCH_TEST_CLIENT, os_index_pattern=&#39;flights&#39;, columns=[&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;])</span>
<span class="sd">    &gt;&gt;&gt; df.head()</span>
<span class="sd">       AvgTicketPrice  Cancelled</span>
<span class="sd">    0      841.265642      False</span>
<span class="sd">    1      882.982662      False</span>
<span class="sd">    2      190.636904      False</span>
<span class="sd">    3      181.694216       True</span>
<span class="sd">    4      730.041778      False</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    [5 rows x 2 columns]</span>

<span class="sd">    Constructing DataFrame from an OpenSearch client and an OpenSearch index, with &#39;timestamp&#39; as the  DataFrame</span>
<span class="sd">    index field</span>
<span class="sd">    (TODO - currently index_field must also be a field if not _id)</span>

<span class="sd">    &gt;&gt;&gt; df = oml.DataFrame(</span>
<span class="sd">    ...     os_client=OPENSEARCH_TEST_CLIENT,</span>
<span class="sd">    ...     os_index_pattern=&#39;flights&#39;,</span>
<span class="sd">    ...     columns=[&#39;AvgTicketPrice&#39;, &#39;timestamp&#39;],</span>
<span class="sd">    ...     os_index_field=&#39;timestamp&#39;</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; df.head()</span>
<span class="sd">                         AvgTicketPrice           timestamp</span>
<span class="sd">    2018-01-01T00:00:00      841.265642 2018-01-01 00:00:00</span>
<span class="sd">    2018-01-01T00:02:06      772.100846 2018-01-01 00:02:06</span>
<span class="sd">    2018-01-01T00:06:27      159.990962 2018-01-01 00:06:27</span>
<span class="sd">    2018-01-01T00:33:31      800.217104 2018-01-01 00:33:31</span>
<span class="sd">    2018-01-01T00:36:51      803.015200 2018-01-01 00:36:51</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    [5 rows x 2 columns]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">os_client</span><span class="p">:</span> <span class="s2">&quot;OpenSearch&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">os_index_pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">os_index_field</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">_query_compiler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;QueryCompiler&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        There are effectively 2 constructors:</span>

<span class="sd">        1. client, index_pattern, columns, index_field</span>
<span class="sd">        2. query_compiler (opensearch_py_ml.QueryCompiler)</span>

<span class="sd">        The constructor with &#39;query_compiler&#39; is for internal use only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_query_compiler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os_client</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">os_index_pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;client and index_pattern must be defined in DataFrame constructor&quot;</span>
                <span class="p">)</span>
        <span class="c1"># python 3 syntax</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">os_client</span><span class="o">=</span><span class="n">os_client</span><span class="p">,</span>
            <span class="n">os_index_pattern</span><span class="o">=</span><span class="n">os_index_pattern</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">os_index_field</span><span class="o">=</span><span class="n">os_index_field</span><span class="p">,</span>
            <span class="n">_query_compiler</span><span class="o">=</span><span class="n">_query_compiler</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The column labels of the DataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Index</span>
<span class="sd">            OpenSearch field names as pandas.Index</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.columns`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; assert isinstance(df.columns, pd.Index)</span>
<span class="sd">        &gt;&gt;&gt; df.columns</span>
<span class="sd">        Index([&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;, &#39;Carrier&#39;, &#39;Dest&#39;, &#39;DestAirportID&#39;, &#39;DestCityName&#39;,</span>
<span class="sd">        ...   &#39;DestCountry&#39;, &#39;DestLocation&#39;, &#39;DestRegion&#39;, &#39;DestWeather&#39;, &#39;DistanceKilometers&#39;,</span>
<span class="sd">        ...   &#39;DistanceMiles&#39;, &#39;FlightDelay&#39;, &#39;FlightDelayMin&#39;, &#39;FlightDelayType&#39;, &#39;FlightNum&#39;,</span>
<span class="sd">        ...   &#39;FlightTimeHour&#39;, &#39;FlightTimeMin&#39;, &#39;Origin&#39;, &#39;OriginAirportID&#39;, &#39;OriginCityName&#39;,</span>
<span class="sd">        ...   &#39;OriginCountry&#39;, &#39;OriginLocation&#39;, &#39;OriginRegion&#39;, &#39;OriginWeather&#39;, &#39;dayOfWeek&#39;,</span>
<span class="sd">        ...   &#39;timestamp&#39;],</span>
<span class="sd">        ...   dtype=&#39;object&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">columns</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determines if the DataFrame is empty.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            If DataFrame is empty, return True, if not return False.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.empty`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df.empty</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

<div class="viewcode-block" id="DataFrame.head">
<a class="viewcode-back" href="../../reference/api/DataFrame.head.html#opensearch_py_ml.DataFrame.head">[docs]</a>
    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the first n rows.</span>

<span class="sd">        This function returns the first n rows for the object based on position.</span>
<span class="sd">        The row order is sorted by index field.</span>
<span class="sd">        It is useful for quickly testing if your object has the right type of data in it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n: int, default 5</span>
<span class="sd">            Number of rows to select.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame</span>
<span class="sd">            opensearch_py_ml DataFrame filtered on first n rows sorted by index field</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.head`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&#39;Origin&#39;, &#39;Dest&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.head(3)</span>
<span class="sd">                                    Origin                                          Dest</span>
<span class="sd">        0        Frankfurt am Main Airport  Sydney Kingsford Smith International Airport</span>
<span class="sd">        1  Cape Town International Airport                     Venice Marco Polo Airport</span>
<span class="sd">        2        Venice Marco Polo Airport                     Venice Marco Polo Airport</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [3 rows x 2 columns]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.tail">
<a class="viewcode-back" href="../../reference/api/DataFrame.tail.html#opensearch_py_ml.DataFrame.tail">[docs]</a>
    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the last n rows.</span>

<span class="sd">        This function returns the last n rows for the object based on position.</span>
<span class="sd">        The row order is sorted by index field.</span>
<span class="sd">        It is useful for quickly testing if your object has the right type of data in it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n: int, default 5</span>
<span class="sd">            Number of rows to select.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame:</span>
<span class="sd">            opensearch_py_ml DataFrame filtered on last n rows sorted by index field</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.tail`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&#39;Origin&#39;, &#39;Dest&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.tail()</span>
<span class="sd">                                                                    Origin  \\</span>
<span class="sd">        13054                                   Pisa International Airport...</span>
<span class="sd">        13055  Winnipeg / James Armstrong Richardson International Airport...</span>
<span class="sd">        13056               Licenciado Benito Juarez International Airport...</span>
<span class="sd">        13057                                                Itami Airport...</span>
<span class="sd">        13058                               Adelaide International Airport...</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">                                                   Dest...</span>
<span class="sd">        13054      Xi&#39;an Xianyang International Airport...</span>
<span class="sd">        13055                            Zurich Airport...</span>
<span class="sd">        13056                         Ukrainka Air Base...</span>
<span class="sd">        13057  Ministro Pistarini International Airport...</span>
<span class="sd">        13058   Washington Dulles International Airport...</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [5 rows x 2 columns]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.sample">
<a class="viewcode-back" href="../../reference/api/DataFrame.sample.html#opensearch_py_ml.DataFrame.sample">[docs]</a>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">frac</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return n randomly sample rows or the specify fraction of rows</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, optional</span>
<span class="sd">            Number of documents from index to return. Cannot be used with `frac`.</span>
<span class="sd">            Default = 1 if `frac` = None.</span>
<span class="sd">        frac : float, optional</span>
<span class="sd">            Fraction of axis items to return. Cannot be used with `n`.</span>
<span class="sd">        random_state : int, optional</span>
<span class="sd">            Seed for the random number generator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame:</span>
<span class="sd">            opensearch_py_ml DataFrame filtered containing n rows randomly sampled</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.sample`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">frac</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;</span> <span class="n">frac</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`frac` must be between 0. and 1.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">frac</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only integers accepted as `n` values&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">frac</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please enter a value for `frac` OR `n`, not both&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="n">frac</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.drop">
<a class="viewcode-back" href="../../reference/api/DataFrame.drop.html#opensearch_py_ml.DataFrame.drop">[docs]</a>
    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return new object with labels in requested axis removed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        labels:</span>
<span class="sd">            Index or column labels to drop.</span>
<span class="sd">        axis:</span>
<span class="sd">            Whether to drop labels from the index (0 / &#39;index&#39;) or columns (1 / &#39;columns&#39;).</span>
<span class="sd">        index, columns:</span>
<span class="sd">            Alternative to specifying axis (labels, axis=1 is equivalent to columns=labels).</span>
<span class="sd">        level:</span>
<span class="sd">            For MultiIndex - not supported</span>
<span class="sd">        inplace:</span>
<span class="sd">            If True, do operation inplace and return None.</span>
<span class="sd">        errors:</span>
<span class="sd">            If &#39;ignore&#39;, suppress error and existing labels are dropped.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dropped:</span>
<span class="sd">            type of caller</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.drop`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Drop a column</span>

<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;ecommerce&#39;, columns=[&#39;customer_first_name&#39;, &#39;email&#39;, &#39;user&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.drop(columns=[&#39;user&#39;])</span>
<span class="sd">             customer_first_name                       email</span>
<span class="sd">        0                  Eddie  eddie@underwood-family.zzz</span>
<span class="sd">        1                   Mary      mary@bailey-family.zzz</span>
<span class="sd">        2                   Gwen      gwen@butler-family.zzz</span>
<span class="sd">        3                  Diane   diane@chandler-family.zzz</span>
<span class="sd">        4                  Eddie      eddie@weber-family.zzz</span>
<span class="sd">        ...                  ...                         ...</span>
<span class="sd">        4670                Mary     mary@lambert-family.zzz</span>
<span class="sd">        4671                 Jim      jim@gilbert-family.zzz</span>
<span class="sd">        4672               Yahya     yahya@rivera-family.zzz</span>
<span class="sd">        4673                Mary     mary@hampton-family.zzz</span>
<span class="sd">        4674             Jackson  jackson@hopkins-family.zzz</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [4675 rows x 2 columns]</span>

<span class="sd">        Drop rows by index value (axis=0)</span>

<span class="sd">        &gt;&gt;&gt; df.drop([&#39;1&#39;, &#39;2&#39;])</span>
<span class="sd">             customer_first_name                       email     user</span>
<span class="sd">        0                  Eddie  eddie@underwood-family.zzz    eddie</span>
<span class="sd">        3                  Diane   diane@chandler-family.zzz    diane</span>
<span class="sd">        4                  Eddie      eddie@weber-family.zzz    eddie</span>
<span class="sd">        5                  Diane    diane@goodwin-family.zzz    diane</span>
<span class="sd">        6                 Oliver      oliver@rios-family.zzz   oliver</span>
<span class="sd">        ...                  ...                         ...      ...</span>
<span class="sd">        4670                Mary     mary@lambert-family.zzz     mary</span>
<span class="sd">        4671                 Jim      jim@gilbert-family.zzz      jim</span>
<span class="sd">        4672               Yahya     yahya@rivera-family.zzz    yahya</span>
<span class="sd">        4673                Mary     mary@hampton-family.zzz     mary</span>
<span class="sd">        4674             Jackson  jackson@hopkins-family.zzz  jackson</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [4673 rows x 3 columns]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Level not supported</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;level not supported </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">inplace</span> <span class="o">=</span> <span class="n">validate_bool_kwarg</span><span class="p">(</span><span class="n">inplace</span><span class="p">,</span> <span class="s2">&quot;inplace&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot specify both &#39;labels&#39; and &#39;index&#39;/&#39;columns&#39;&quot;</span><span class="p">)</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">_get_axis_name</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="p">:</span> <span class="n">labels</span><span class="p">}</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">_construct_axes_from_arguments</span><span class="p">(</span>
                <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="p">),</span> <span class="p">{}</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Need to specify at least one of &#39;labels&#39;, &#39;index&#39; or &#39;columns&#39;&quot;</span>
            <span class="p">)</span>

        <span class="c1"># TODO Clean up this error checking</span>
        <span class="k">if</span> <span class="s2">&quot;index&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_list_like</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]):</span>
                <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
                <span class="c1"># Check if axes[&#39;index&#39;] values exists in index</span>
                <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_index_matches_count</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;number of labels </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">!=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> not contained in axis&quot;</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                axes[&quot;index&quot;] = self._query_compiler.index_matches(axes[&quot;index&quot;])</span>
<span class="sd">                # If the length is zero, we will just do nothing</span>
<span class="sd">                if not len(axes[&quot;index&quot;]):</span>
<span class="sd">                    axes[&quot;index&quot;] = None</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;columns&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_list_like</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]):</span>
                <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
                <span class="n">non_existant</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_existant</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;labels </span><span class="si">{</span><span class="n">non_existant</span><span class="si">}</span><span class="s2"> not contained in axis&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
                <span class="p">]</span>
                <span class="c1"># If the length is zero, we will just do nothing</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]):</span>
                    <span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">new_query_compiler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_or_update_from_compiler</span><span class="p">(</span><span class="n">new_query_compiler</span><span class="p">,</span> <span class="n">inplace</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provide autocompletion on field names in interactive environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span>
            <span class="n">column_name</span>
            <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">is_valid_attr_name</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        From pandas</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>

        <span class="c1"># max_rows and max_cols determine the maximum size of the pretty printed tabular</span>
        <span class="c1"># representation of the dataframe. pandas defaults are 60 and 20 respectively.</span>
        <span class="c1"># dataframes where len(df) &gt; max_rows shows a truncated view with 10 rows shown.</span>
        <span class="n">max_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>
        <span class="n">max_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">)</span>
        <span class="n">min_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.min_rows&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_rows</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="n">min_rows</span>

        <span class="n">show_dimensions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.show_dimensions&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.expand_frame_repr&quot;</span><span class="p">):</span>
            <span class="n">width</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">get_console_size</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span>
            <span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
            <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span>
            <span class="n">max_cols</span><span class="o">=</span><span class="n">max_cols</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
            <span class="n">show_dimensions</span><span class="o">=</span><span class="n">show_dimensions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_info_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if the repr should show the info view.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info_repr_option</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.large_repr&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;info&quot;</span>
        <span class="k">return</span> <span class="n">info_repr_option</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_repr_fits_horizontal_</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repr_fits_vertical_</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        From pandas - this is called by notebooks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_repr</span><span class="p">():</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">buf</span><span class="o">=</span><span class="n">buf</span><span class="p">)</span>
            <span class="c1"># need to escape the &lt;class&gt;, should be the first line.</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&amp;lt;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span> <span class="o">+</span> <span class="n">val</span> <span class="o">+</span> <span class="s2">&quot;&lt;/pre&gt;&quot;</span>

        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.notebook_repr_html&quot;</span><span class="p">):</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>
            <span class="n">max_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">)</span>
            <span class="n">min_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.min_rows&quot;</span><span class="p">)</span>
            <span class="n">show_dimensions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.show_dimensions&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_rows</span><span class="p">:</span>
                <span class="n">max_rows</span> <span class="o">=</span> <span class="n">min_rows</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span>
                <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span>
                <span class="n">max_cols</span><span class="o">=</span><span class="n">max_cols</span><span class="p">,</span>
                <span class="n">show_dimensions</span><span class="o">=</span><span class="n">show_dimensions</span><span class="p">,</span>
                <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>  <span class="c1"># set for consistency with pandas output</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="DataFrame.count">
<a class="viewcode-back" href="../../reference/api/DataFrame.count.html#opensearch_py_ml.DataFrame.count">[docs]</a>
    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Count non-NA cells for each column.</span>

<span class="sd">        Counts are based on exists queries against ES.</span>

<span class="sd">        This is inefficient, as it creates N queries (N is number of fields).</span>
<span class="sd">        An alternative approach is to use value_count aggregations. However, they have issues in that:</span>

<span class="sd">        - They can only be used with aggregatable fields (e.g. keyword not text)</span>
<span class="sd">        - For list fields they return multiple counts. E.g. tags=[&#39;opensearch-project&#39;, &#39;ml&#39;] returns value_count=2 for a</span>
<span class="sd">          single document.</span>

<span class="sd">        TODO - add additional pandas.DataFrame.count features</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series:</span>
<span class="sd">            Summary of column counts</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.count`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;ecommerce&#39;, columns=[&#39;customer_first_name&#39;, &#39;geoip.city_name&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.count()</span>
<span class="sd">        customer_first_name    4675</span>
<span class="sd">        geoip.city_name        4094</span>
<span class="sd">        dtype: int64</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">count</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.os_info">
<a class="viewcode-back" href="../../reference/api/DataFrame.os_info.html#opensearch_py_ml.DataFrame.os_info">[docs]</a>
    <span class="k">def</span> <span class="nf">os_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># noinspection PyPep8</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A debug summary of an opensearch_py_ml DataFrame internals.</span>

<span class="sd">        This includes the OpenSearch search queries and query compiler task list.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A debug summary of an opensearch_py_ml DataFrame internals.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df = df[(df.OriginAirportID == &#39;AMS&#39;) &amp; (df.FlightDelayMin &gt; 60)]</span>
<span class="sd">        &gt;&gt;&gt; df = df[[&#39;timestamp&#39;, &#39;OriginAirportID&#39;, &#39;DestAirportID&#39;, &#39;FlightDelayMin&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; df = df.tail()</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                        timestamp OriginAirportID DestAirportID  FlightDelayMin</span>
<span class="sd">        12608 2018-02-10 01:20:52             AMS          CYEG             120</span>
<span class="sd">        12720 2018-02-10 14:09:40             AMS           BHM             255</span>
<span class="sd">        12725 2018-02-10 00:53:01             AMS           ATL             360</span>
<span class="sd">        12823 2018-02-10 15:41:20             AMS           NGO             120</span>
<span class="sd">        12907 2018-02-11 20:08:25             AMS           LIM             225</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [5 rows x 4 columns]</span>
<span class="sd">        &gt;&gt;&gt; print(df.os_info())</span>
<span class="sd">        os_index_pattern: flights</span>
<span class="sd">        Index:</span>
<span class="sd">         os_index_field: _id</span>
<span class="sd">         is_source_field: False</span>
<span class="sd">        Mappings:</span>
<span class="sd">         capabilities:</span>
<span class="sd">                           os_field_name  is_source os_dtype                  os_date_format        pd_dtype  is_searchable  is_aggregatable  is_scripted aggregatable_os_field_name</span>
<span class="sd">        timestamp              timestamp       True     date  strict_date_hour_minute_second  datetime64[ns]           True             True        False                  timestamp</span>
<span class="sd">        OriginAirportID  OriginAirportID       True  keyword                            None          object           True             True        False            OriginAirportID</span>
<span class="sd">        DestAirportID      DestAirportID       True  keyword                            None          object           True             True        False              DestAirportID</span>
<span class="sd">        FlightDelayMin    FlightDelayMin       True  integer                            None           int64           True             True        False             FlightDelayMin</span>
<span class="sd">        Operations:</span>
<span class="sd">         tasks: [(&#39;boolean_filter&#39;: (&#39;boolean_filter&#39;: {&#39;bool&#39;: {&#39;must&#39;: [{&#39;term&#39;: {&#39;OriginAirportID&#39;: &#39;AMS&#39;}}, {&#39;range&#39;: {&#39;FlightDelayMin&#39;: {&#39;gt&#39;: 60}}}]}})), (&#39;tail&#39;: (&#39;sort_field&#39;: &#39;_doc&#39;, &#39;count&#39;: 5))]</span>
<span class="sd">         size: 5</span>
<span class="sd">         sort_params: {&#39;_doc&#39;: &#39;desc&#39;}</span>
<span class="sd">         _source: [&#39;timestamp&#39;, &#39;OriginAirportID&#39;, &#39;DestAirportID&#39;, &#39;FlightDelayMin&#39;]</span>
<span class="sd">         body: {&#39;query&#39;: {&#39;bool&#39;: {&#39;must&#39;: [{&#39;term&#39;: {&#39;OriginAirportID&#39;: &#39;AMS&#39;}}, {&#39;range&#39;: {&#39;FlightDelayMin&#39;: {&#39;gt&#39;: 60}}}]}}}</span>
<span class="sd">         post_processing: [(&#39;sort_index&#39;)]</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_os_info</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.os_match">
<a class="viewcode-back" href="../../reference/api/DataFrame.os_match.html#opensearch_py_ml.DataFrame.os_match">[docs]</a>
    <span class="k">def</span> <span class="nf">os_match</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">match_phrase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">must_not_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">multi_match_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">match_only_text_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">analyzer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fuzziness</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filters data with an OpenSearch ``match``, ``match_phrase``, or</span>
<span class="sd">        ``multi_match`` query depending on the given parameters and columns.</span>

<span class="sd">        Read more about `Full-Text Queries in OpenSearch &lt;https://opensearch.org/docs/latest/opensearch/query-dsl/full-text/&gt;`_</span>

<span class="sd">        By default all fields of type &#39;text&#39; within OpenSearch are queried</span>
<span class="sd">        otherwise specific columns can be specified via the ``columns`` parameter</span>
<span class="sd">        or a single column can be filtered on with :py:meth:`opensearch_py_ml.Series.os_match`</span>

<span class="sd">        All additional keyword arguments are passed in the body of the match query.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text: str</span>
<span class="sd">            String of text to search for</span>
<span class="sd">        columns: str, List[str], optional</span>
<span class="sd">            List of columns to search over. Defaults to all &#39;text&#39; fields in OpenSearch</span>
<span class="sd">        match_phrase: bool, default False</span>
<span class="sd">            If True will use ``match_phrase`` instead of ``match`` query which takes into account</span>
<span class="sd">            the order of the ``text`` parameter.</span>
<span class="sd">        must_not_match: bool, default False</span>
<span class="sd">            If True will apply a boolean NOT (~) to the</span>
<span class="sd">            query. Instead of requiring a match the query</span>
<span class="sd">            will require text to not match.</span>
<span class="sd">        multi_match_type: str, optional</span>
<span class="sd">            If given and matching against multiple columns will set the ``multi_match.type`` setting</span>
<span class="sd">        match_only_text_fields: bool, default True</span>
<span class="sd">            When True this function will raise an error if any non-text fields</span>
<span class="sd">            are queried to prevent fields that aren&#39;t analyzed from not working properly.</span>
<span class="sd">            Set to False to ignore this preventative check.</span>
<span class="sd">        analyzer: str, optional</span>
<span class="sd">            Specify which analyzer to use for the match query</span>
<span class="sd">        fuzziness: int, str, optional</span>
<span class="sd">            Specify the fuzziness option for the match query</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            A filtered :py:class:`opensearch_py_ml.DataFrame` with the given match query</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &quot;ecommerce&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.os_match(&quot;Men&#39;s&quot;, columns=[&quot;category&quot;])</span>
<span class="sd">                                                      category currency  ...   type     user</span>
<span class="sd">        0                                     [Men&#39;s Clothing]      EUR  ...  order    eddie</span>
<span class="sd">        4                  [Men&#39;s Clothing, Men&#39;s Accessories]      EUR  ...  order    eddie</span>
<span class="sd">        6                                     [Men&#39;s Clothing]      EUR  ...  order   oliver</span>
<span class="sd">        7     [Men&#39;s Clothing, Men&#39;s Accessories, Men&#39;s Shoes]      EUR  ...  order      abd</span>
<span class="sd">        11                 [Men&#39;s Accessories, Men&#39;s Clothing]      EUR  ...  order    eddie</span>
<span class="sd">        ...                                                ...      ...  ...    ...      ...</span>
<span class="sd">        4663                     [Men&#39;s Shoes, Men&#39;s Clothing]      EUR  ...  order    samir</span>
<span class="sd">        4667                     [Men&#39;s Clothing, Men&#39;s Shoes]      EUR  ...  order   sultan</span>
<span class="sd">        4671                                  [Men&#39;s Clothing]      EUR  ...  order      jim</span>
<span class="sd">        4672                                  [Men&#39;s Clothing]      EUR  ...  order    yahya</span>
<span class="sd">        4674             [Women&#39;s Accessories, Men&#39;s Clothing]      EUR  ...  order  jackson</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [2310 rows x 45 columns]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Determine which columns will be used</span>
        <span class="n">os_dtypes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">os_dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">column</span> <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">os_dtype</span> <span class="ow">in</span> <span class="n">os_dtypes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">os_dtype</span> <span class="o">==</span> <span class="s2">&quot;text&quot;</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

        <span class="n">qc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">qc</span><span class="o">.</span><span class="n">os_match</span><span class="p">(</span>
            <span class="n">text</span><span class="p">,</span>
            <span class="n">columns</span><span class="p">,</span>
            <span class="n">match_phrase</span><span class="o">=</span><span class="n">match_phrase</span><span class="p">,</span>
            <span class="n">match_only_text_fields</span><span class="o">=</span><span class="n">match_only_text_fields</span><span class="p">,</span>
            <span class="n">multi_match_type</span><span class="o">=</span><span class="n">multi_match_type</span><span class="p">,</span>
            <span class="n">analyzer</span><span class="o">=</span><span class="n">analyzer</span><span class="p">,</span>
            <span class="n">fuzziness</span><span class="o">=</span><span class="n">fuzziness</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">must_not_match</span><span class="p">:</span>
            <span class="nb">filter</span> <span class="o">=</span> <span class="o">~</span><span class="nb">filter</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="n">qc</span><span class="o">.</span><span class="n">_update_query</span><span class="p">(</span><span class="nb">filter</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.os_query">
<a class="viewcode-back" href="../../reference/api/DataFrame.os_query.html#opensearch_py_ml.DataFrame.os_query">[docs]</a>
    <span class="k">def</span> <span class="nf">os_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies an OpenSearch DSL query to the current DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query:</span>
<span class="sd">            Dictionary of the OpenSearch DSL query to apply</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame:</span>
<span class="sd">            opensearch_py_ml DataFrame with the query applied</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Apply a `geo-distance query`_ to a dataset with a geo-point column ``geoip.location``.</span>

<span class="sd">         .. _geo-distance query documentation from Elasticsearch: https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-geo-distance-query.html</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;ecommerce&#39;, columns=[&#39;customer_first_name&#39;, &#39;geoip.city_name&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.os_query({&quot;bool&quot;: {&quot;filter&quot;: {&quot;geo_distance&quot;: {&quot;distance&quot;: &quot;1km&quot;, &quot;geoip.location&quot;: [55.3, 25.3]}}}}).head()</span>
<span class="sd">           customer_first_name geoip.city_name</span>
<span class="sd">        1                 Mary           Dubai</span>
<span class="sd">        9            Rabbia Al           Dubai</span>
<span class="sd">        10           Rabbia Al           Dubai</span>
<span class="sd">        22                Mary           Dubai</span>
<span class="sd">        30              Robbie           Dubai</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [5 rows x 2 columns]</span>

<span class="sd">        If using an occurrence like ``must`` or ``filter`` you must</span>
<span class="sd">        nest it within ``bool``:</span>

<span class="sd">         .. code-block:: python</span>

<span class="sd">            # Correct:</span>
<span class="sd">            df.os_query({</span>
<span class="sd">                &quot;bool&quot;: {</span>
<span class="sd">                    &quot;filter&quot;: {...}</span>
<span class="sd">                }</span>
<span class="sd">            })</span>

<span class="sd">            # Incorrect, needs to be nested under &#39;bool&#39;:</span>
<span class="sd">            df.os_query({</span>
<span class="sd">                &quot;filter&quot;: {...}</span>
<span class="sd">            })</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Unpack the {&#39;query&#39;: ...} which some</span>
        <span class="c1"># users may use due to documentation.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;query&#39; must be of type &#39;dict&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;query&quot;</span><span class="p">,):</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">os_query</span><span class="p">(</span><span class="n">query</span><span class="p">))</span></div>


    <span class="k">def</span> <span class="nf">_index_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Print index summary e.g.</span>
        <span class="c1"># Index: 103 entries, 0 to 102</span>
        <span class="c1"># Do this by getting head and tail of dataframe</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="c1"># index[0] is out of bounds for empty df</span>
            <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">index_summary</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, </span><span class="si">{</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">head</span><span class="p">)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> entries</span><span class="si">{</span><span class="n">index_summary</span><span class="si">}</span><span class="s2">&quot;</span>

<div class="viewcode-block" id="DataFrame.info">
<a class="viewcode-back" href="../../reference/api/DataFrame.info.html#opensearch_py_ml.DataFrame.info">[docs]</a>
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">buf</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StringIO</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">memory_usage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_counts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print a concise summary of a DataFrame.</span>

<span class="sd">        This method prints information about a DataFrame including</span>
<span class="sd">        the index dtype and column dtypes, non-null values and memory usage.</span>

<span class="sd">        See :pandas_api_docs:`pandas.DataFrame.info` for full details.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This copies a lot of code from pandas.DataFrame.info as it is difficult</span>
<span class="sd">        to split out the appropriate code or creating a SparseDataFrame gives</span>
<span class="sd">        incorrect results on types and counts.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;ecommerce&#39;, columns=[&#39;customer_first_name&#39;, &#39;geoip.city_name&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.info()</span>
<span class="sd">        &lt;class &#39;opensearch_py_ml.dataframe.DataFrame&#39;&gt;</span>
<span class="sd">        Index: 4675 entries, 0 to 4674</span>
<span class="sd">        Data columns (total 2 columns):</span>
<span class="sd">         #   Column               Non-Null Count  Dtype...</span>
<span class="sd">        ---  ------               --------------  -----...</span>
<span class="sd">         0   customer_first_name  4675 non-null   object</span>
<span class="sd">         1   geoip.city_name      4094 non-null   object</span>
<span class="sd">        dtypes: object(2)</span>
<span class="sd">        memory usage: ...</span>
<span class="sd">        OpenSearch storage usage: ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">buf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_summary</span><span class="p">()]</span>

        <span class="n">columns</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">number_of_columns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">number_of_columns</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Empty </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">buffer_put_lines</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># hack</span>
        <span class="k">if</span> <span class="n">max_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_info_columns&quot;</span><span class="p">,</span> <span class="n">number_of_columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">max_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_info_rows&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_counts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">show_counts</span> <span class="o">=</span> <span class="p">(</span><span class="n">number_of_columns</span> <span class="o">&lt;=</span> <span class="n">max_cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_rows</span><span class="p">)</span>

        <span class="n">exceeds_info_cols</span> <span class="o">=</span> <span class="n">number_of_columns</span> <span class="o">&gt;</span> <span class="n">max_cols</span>

        <span class="c1"># From pandas.DataFrame</span>
        <span class="k">def</span> <span class="nf">_put_str</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">[:</span><span class="n">space</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_verbose_repr</span><span class="p">(</span><span class="n">number_of_columns</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data columns (total </span><span class="si">{</span><span class="n">number_of_columns</span><span class="si">}</span><span class="s2"> columns):&quot;</span><span class="p">)</span>

            <span class="n">id_head</span> <span class="o">=</span> <span class="s2">&quot; # &quot;</span>
            <span class="n">column_head</span> <span class="o">=</span> <span class="s2">&quot;Column&quot;</span>
            <span class="n">col_space</span> <span class="o">=</span> <span class="mi">2</span>

            <span class="n">max_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">)</span>
            <span class="n">len_column</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">column_head</span><span class="p">))</span>
            <span class="n">space</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_col</span><span class="p">,</span> <span class="n">len_column</span><span class="p">)</span> <span class="o">+</span> <span class="n">col_space</span>

            <span class="n">max_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">number_of_columns</span><span class="p">))</span>
            <span class="n">len_id</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">id_head</span><span class="p">))</span>
            <span class="n">space_num</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_id</span><span class="p">,</span> <span class="n">len_id</span><span class="p">)</span> <span class="o">+</span> <span class="n">col_space</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">header</span> <span class="o">=</span> <span class="n">_put_str</span><span class="p">(</span><span class="n">id_head</span><span class="p">,</span> <span class="n">space_num</span><span class="p">)</span> <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="n">column_head</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show_counts</span><span class="p">:</span>
                <span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">number_of_columns</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
                    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Columns must equal counts (</span><span class="si">{</span><span class="n">number_of_columns</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="p">)</span>
                <span class="n">count_header</span> <span class="o">=</span> <span class="s2">&quot;Non-Null Count&quot;</span>
                <span class="n">len_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_header</span><span class="p">)</span>
                <span class="n">non_null</span> <span class="o">=</span> <span class="s2">&quot; non-null&quot;</span>
                <span class="n">max_count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_null</span><span class="p">)</span>
                <span class="n">space_count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">len_count</span><span class="p">,</span> <span class="n">max_count</span><span class="p">)</span> <span class="o">+</span> <span class="n">col_space</span>
                <span class="n">count_temp</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{count}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">non_null</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">count_header</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">space_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_header</span><span class="p">)</span>
                <span class="n">len_count</span> <span class="o">=</span> <span class="n">space_count</span>
                <span class="n">count_temp</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{count}</span><span class="s2">&quot;</span>

            <span class="n">dtype_header</span> <span class="o">=</span> <span class="s2">&quot;Dtype&quot;</span>
            <span class="n">len_dtype</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dtype_header</span><span class="p">)</span>
            <span class="n">max_dtypes</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pprint_thing</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
            <span class="n">space_dtype</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">len_dtype</span><span class="p">,</span> <span class="n">max_dtypes</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">+=</span> <span class="n">_put_str</span><span class="p">(</span><span class="n">count_header</span><span class="p">,</span> <span class="n">space_count</span><span class="p">)</span> <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span>
                <span class="n">dtype_header</span><span class="p">,</span> <span class="n">space_dtype</span>
            <span class="p">)</span>

            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_put_str</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">len_id</span><span class="p">,</span> <span class="n">space_num</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">len_column</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">len_count</span><span class="p">,</span> <span class="n">space_count</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">len_dtype</span><span class="p">,</span> <span class="n">space_dtype</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">dtypes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">pprint_thing</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

                <span class="n">line_no</span> <span class="o">=</span> <span class="n">_put_str</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">space_num</span><span class="p">)</span>

                <span class="n">count</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="n">show_counts</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">line_no</span>
                    <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">space</span><span class="p">)</span>
                    <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="n">count_temp</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">),</span> <span class="n">space_count</span><span class="p">)</span>
                    <span class="o">+</span> <span class="n">_put_str</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">space_dtype</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">def</span> <span class="nf">_non_verbose_repr</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columns</span><span class="o">.</span><span class="n">_summary</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Columns&quot;</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">_sizeof_fmt</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">size_qualifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># returns size in human readable format</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bytes&quot;</span><span class="p">,</span> <span class="s2">&quot;KB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;GB&quot;</span><span class="p">,</span> <span class="s2">&quot;TB&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mf">1024.0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">3.3f</span><span class="si">}{</span><span class="n">size_qualifier</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">num</span> <span class="o">/=</span> <span class="mf">1024.0</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">3.3f</span><span class="si">}{</span><span class="n">size_qualifier</span><span class="si">}</span><span class="s2"> PB&quot;</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">_verbose_repr</span><span class="p">(</span><span class="n">number_of_columns</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">verbose</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># specifically set to False, not nesc None</span>
            <span class="n">_non_verbose_repr</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_non_verbose_repr</span><span class="p">()</span> <span class="k">if</span> <span class="n">exceeds_info_cols</span> <span class="k">else</span> <span class="n">_verbose_repr</span><span class="p">(</span>
                <span class="n">number_of_columns</span>
            <span class="p">)</span>

        <span class="c1"># pandas 0.25.1 uses get_dtype_counts() here. This</span>
        <span class="c1"># returns a Series with strings as the index NOT dtypes.</span>
        <span class="c1"># Therefore, to get consistent ordering we need to</span>
        <span class="c1"># align types with pandas method.</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">counts</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">())]</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dtypes: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dtypes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">memory_usage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">memory_usage</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.memory_usage&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">memory_usage</span><span class="p">:</span>
            <span class="c1"># append memory usage of df to display</span>
            <span class="n">size_qualifier</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># TODO - this is different from pd.DataFrame as we shouldn&#39;t</span>
            <span class="c1">#   really hold much in memory. For now just approximate with getsizeof + ignore deep</span>
            <span class="n">mem_usage</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;memory usage: </span><span class="si">{</span><span class="n">_sizeof_fmt</span><span class="p">(</span><span class="n">mem_usage</span><span class="p">,</span><span class="w"> </span><span class="n">size_qualifier</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">storage_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span>
                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_index_pattern</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;store&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="s2">&quot;_all&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">][</span><span class="s2">&quot;store&quot;</span><span class="p">][</span><span class="s2">&quot;size_in_bytes&quot;</span><span class="p">]</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;OpenSearch storage usage: </span><span class="si">{</span><span class="n">_sizeof_fmt</span><span class="p">(</span><span class="n">storage_usage</span><span class="p">,</span><span class="w"> </span><span class="n">size_qualifier</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">fmt</span><span class="o">.</span><span class="n">buffer_put_lines</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.to_html">
<a class="viewcode-back" href="../../reference/api/DataFrame.to_html.html#opensearch_py_ml.DataFrame.to_html">[docs]</a>
    <span class="nd">@docstring_parameter</span><span class="p">(</span><span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">to_html</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">buf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">col_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">na_rep</span><span class="o">=</span><span class="s2">&quot;NaN&quot;</span><span class="p">,</span>
        <span class="n">formatters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">float_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sparsify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">index_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">justify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show_dimensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">bold_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">classes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">escape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">notebook</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">border</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">table_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">render_links</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Render a OpenSearch data as an HTML table.</span>

<span class="sd">        Follows pandas implementation except when ``max_rows=None``. In this scenario, we set ``max_rows={0}`` to avoid</span>
<span class="sd">        accidentally dumping an entire index. This can be overridden by explicitly setting ``max_rows``.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.to_html`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In pandas calling &#39;to_string&#39; without max_rows set, will dump ALL rows - we avoid this</span>
        <span class="c1"># by limiting rows by default.</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># avoid multiple calls</span>
        <span class="k">if</span> <span class="n">num_rows</span> <span class="o">&lt;=</span> <span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_rows</span> <span class="o">=</span> <span class="n">num_rows</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_rows</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">max_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;DataFrame.to_string called without max_rows set &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;- this will return entire index results. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Setting max_rows=</span><span class="si">{</span><span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; overwrite if different behaviour is required.&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span>

        <span class="c1"># because of the way pandas handles max_rows=0, not having this throws an error</span>
        <span class="c1"># see opensearch_py_ml issue #56</span>
        <span class="k">if</span> <span class="n">max_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Create a slightly bigger dataframe than display</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_repr</span><span class="p">(</span><span class="n">max_rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">buf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_buf</span> <span class="o">=</span> <span class="n">_expand_user</span><span class="p">(</span><span class="n">stringify_path</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_buf</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>

        <span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span>
            <span class="n">buf</span><span class="o">=</span><span class="n">_buf</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">col_space</span><span class="o">=</span><span class="n">col_space</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">na_rep</span><span class="o">=</span><span class="n">na_rep</span><span class="p">,</span>
            <span class="n">formatters</span><span class="o">=</span><span class="n">formatters</span><span class="p">,</span>
            <span class="n">float_format</span><span class="o">=</span><span class="n">float_format</span><span class="p">,</span>
            <span class="n">sparsify</span><span class="o">=</span><span class="n">sparsify</span><span class="p">,</span>
            <span class="n">index_names</span><span class="o">=</span><span class="n">index_names</span><span class="p">,</span>
            <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span>
            <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span>
            <span class="n">max_cols</span><span class="o">=</span><span class="n">max_cols</span><span class="p">,</span>
            <span class="n">show_dimensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span>
            <span class="n">bold_rows</span><span class="o">=</span><span class="n">bold_rows</span><span class="p">,</span>
            <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span>
            <span class="n">escape</span><span class="o">=</span><span class="n">escape</span><span class="p">,</span>
            <span class="n">notebook</span><span class="o">=</span><span class="n">notebook</span><span class="p">,</span>
            <span class="n">border</span><span class="o">=</span><span class="n">border</span><span class="p">,</span>
            <span class="n">table_id</span><span class="o">=</span><span class="n">table_id</span><span class="p">,</span>
            <span class="n">render_links</span><span class="o">=</span><span class="n">render_links</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Our fake dataframe has incorrect number of rows (max_rows*2+1) - write out</span>
        <span class="c1"># the correct number of rows</span>
        <span class="k">if</span> <span class="n">show_dimensions</span><span class="p">:</span>
            <span class="c1"># TODO - this results in different output to pandas</span>
            <span class="c1"># TODO - the &#39;x&#39; character is different and this gets added after the &lt;/div&gt;</span>
            <span class="n">_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&lt;p&gt;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows × </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns&lt;/p&gt;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">buf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="DataFrame.to_string">
<a class="viewcode-back" href="../../reference/api/DataFrame.to_string.html#opensearch_py_ml.DataFrame.to_string">[docs]</a>
    <span class="nd">@docstring_parameter</span><span class="p">(</span><span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">buf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">col_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">na_rep</span><span class="o">=</span><span class="s2">&quot;NaN&quot;</span><span class="p">,</span>
        <span class="n">formatters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">float_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sparsify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">index_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">justify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show_dimensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">line_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Render a DataFrame to a console-friendly tabular output.</span>

<span class="sd">        Follows pandas implementation except when ``max_rows=None``. In this scenario, we set ``max_rows={0}`` to avoid</span>
<span class="sd">        accidentally dumping an entire index. This can be overridden by explicitly setting ``max_rows``.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.to_string`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In pandas calling &#39;to_string&#39; without max_rows set, will dump ALL rows - we avoid this</span>
        <span class="c1"># by limiting rows by default.</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># avoid multiple calls</span>
        <span class="k">if</span> <span class="n">num_rows</span> <span class="o">&lt;=</span> <span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_rows</span> <span class="o">=</span> <span class="n">num_rows</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_rows</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">max_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;DataFrame.to_string called without max_rows set &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;- this will return entire index results. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Setting max_rows=</span><span class="si">{</span><span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; overwrite if different behaviour is required.&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_ROWS_DISPLAYED</span>

        <span class="c1"># because of the way pandas handles max_rows=0, not having this throws an error</span>
        <span class="c1"># see opensearch_py_ml issue #56</span>
        <span class="k">if</span> <span class="n">max_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">max_rows</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Create a slightly bigger dataframe than display</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_repr</span><span class="p">(</span><span class="n">max_rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">buf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_buf</span> <span class="o">=</span> <span class="n">_expand_user</span><span class="p">(</span><span class="n">stringify_path</span><span class="p">(</span><span class="n">buf</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_buf</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>

        <span class="n">df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span>
            <span class="n">buf</span><span class="o">=</span><span class="n">_buf</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">col_space</span><span class="o">=</span><span class="n">col_space</span><span class="p">,</span>
            <span class="n">na_rep</span><span class="o">=</span><span class="n">na_rep</span><span class="p">,</span>
            <span class="n">formatters</span><span class="o">=</span><span class="n">formatters</span><span class="p">,</span>
            <span class="n">float_format</span><span class="o">=</span><span class="n">float_format</span><span class="p">,</span>
            <span class="n">sparsify</span><span class="o">=</span><span class="n">sparsify</span><span class="p">,</span>
            <span class="n">justify</span><span class="o">=</span><span class="n">justify</span><span class="p">,</span>
            <span class="n">index_names</span><span class="o">=</span><span class="n">index_names</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span>
            <span class="n">max_cols</span><span class="o">=</span><span class="n">max_cols</span><span class="p">,</span>
            <span class="n">show_dimensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># print this outside of this call</span>
            <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span>
            <span class="n">line_width</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Our fake dataframe has incorrect number of rows (max_rows*2+1) - write out</span>
        <span class="c1"># the correct number of rows</span>
        <span class="k">if</span> <span class="n">show_dimensions</span><span class="p">:</span>
            <span class="n">_buf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">[</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2"> rows x </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns]&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">buf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_buf</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span></div>


    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;After regular attribute access, looks up the name in the columns</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            key: str</span>
<span class="sd">                Attribute name.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            The value of the attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">_getitem</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;DataFrame&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">BooleanFilter</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
        <span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the column specified by key for this DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            key : The column name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Pandas Series representing the value for the column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">apply_if_callable</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Shortcut if key is an actual column</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_column</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_array</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">BooleanFilter</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_update_query</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_column</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getitem_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Series&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested column [</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">] is not in the DataFrame.&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduce_dimension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">getitem_column_array</span><span class="p">([</span><span class="n">key</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">_getitem_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Series</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_bool_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Boolean Series key will be reindexed to match DataFrame index.&quot;</span><span class="p">,</span>
                    <span class="ne">PendingDeprecationWarning</span><span class="p">,</span>
                    <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Item wrong length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2"> instead of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">check_bool_indexer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="c1"># We convert to a RangeIndex because getitem_row_array is expecting a list</span>
            <span class="c1"># of indices, and RangeIndex will give us the exact indices of each boolean</span>
            <span class="c1"># requested.</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">))[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
                    <span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">getitem_row_array</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">([</span><span class="n">k</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; not index&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">getitem_column_array</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_or_update_from_compiler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">new_query_compiler</span><span class="p">:</span> <span class="s2">&quot;QueryCompiler&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;QueryCompiler&quot;</span><span class="p">,</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns or updates a DataFrame given new query_compiler&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_query_compiler</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="p">))</span>
            <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">new_query_compiler</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__bases__</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Invalid Query Compiler object: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_query_compiler</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="n">new_query_compiler</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="p">:</span> <span class="s2">&quot;QueryCompiler&quot;</span> <span class="o">=</span> <span class="n">new_query_compiler</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_reduce_dimension</span><span class="p">(</span><span class="n">query_compiler</span><span class="p">:</span> <span class="s2">&quot;QueryCompiler&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Series&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Series</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="n">query_compiler</span><span class="p">)</span>

<div class="viewcode-block" id="DataFrame.to_csv">
<a class="viewcode-back" href="../../reference/api/DataFrame.to_csv.html#opensearch_py_ml.DataFrame.to_csv">[docs]</a>
    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path_or_buf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="n">na_rep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">float_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">index_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
        <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;infer&quot;</span><span class="p">,</span>
        <span class="n">quoting</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
        <span class="n">line_terminator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chunksize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tupleize_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">doublequote</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">escapechar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write OpenSearch data to a comma-separated values (csv) file.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.to_csv`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;path_or_buf&quot;</span><span class="p">:</span> <span class="n">path_or_buf</span><span class="p">,</span>
            <span class="s2">&quot;sep&quot;</span><span class="p">:</span> <span class="n">sep</span><span class="p">,</span>
            <span class="s2">&quot;na_rep&quot;</span><span class="p">:</span> <span class="n">na_rep</span><span class="p">,</span>
            <span class="s2">&quot;float_format&quot;</span><span class="p">:</span> <span class="n">float_format</span><span class="p">,</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
            <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="n">header</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">index</span><span class="p">,</span>
            <span class="s2">&quot;index_label&quot;</span><span class="p">:</span> <span class="n">index_label</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
            <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="n">encoding</span><span class="p">,</span>
            <span class="s2">&quot;compression&quot;</span><span class="p">:</span> <span class="n">compression</span><span class="p">,</span>
            <span class="s2">&quot;quoting&quot;</span><span class="p">:</span> <span class="n">quoting</span><span class="p">,</span>
            <span class="s2">&quot;quotechar&quot;</span><span class="p">:</span> <span class="n">quotechar</span><span class="p">,</span>
            <span class="s2">&quot;line_terminator&quot;</span><span class="p">:</span> <span class="n">line_terminator</span><span class="p">,</span>
            <span class="s2">&quot;chunksize&quot;</span><span class="p">:</span> <span class="n">chunksize</span><span class="p">,</span>
            <span class="s2">&quot;date_format&quot;</span><span class="p">:</span> <span class="n">date_format</span><span class="p">,</span>
            <span class="s2">&quot;doublequote&quot;</span><span class="p">:</span> <span class="n">doublequote</span><span class="p">,</span>
            <span class="s2">&quot;escapechar&quot;</span><span class="p">:</span> <span class="n">escapechar</span><span class="p">,</span>
            <span class="s2">&quot;decimal&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.to_pandas">
<a class="viewcode-back" href="../../reference/api/DataFrame.to_pandas.html#opensearch_py_ml.DataFrame.to_pandas">[docs]</a>
    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Utility method to convert opensearch_py_ml.Dataframe to pandas.Dataframe</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_empty_pd_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_empty_pd_ef</span><span class="p">()</span>

<div class="viewcode-block" id="DataFrame.select_dtypes">
<a class="viewcode-back" href="../../reference/api/DataFrame.select_dtypes.html#opensearch_py_ml.DataFrame.select_dtypes">[docs]</a>
    <span class="k">def</span> <span class="nf">select_dtypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a subset of the DataFrame&#39;s columns based on the column dtypes.</span>

<span class="sd">        Compatible with :pandas_api_docs:`pandas.DataFrame.select_dtypes`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame</span>
<span class="sd">            DataFrame contains only columns of selected dtypes</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;,</span>
<span class="sd">        ... columns=[&#39;AvgTicketPrice&#39;, &#39;Dest&#39;, &#39;Cancelled&#39;, &#39;timestamp&#39;, &#39;dayOfWeek&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.dtypes</span>
<span class="sd">        AvgTicketPrice           float64</span>
<span class="sd">        Dest                      object</span>
<span class="sd">        Cancelled                   bool</span>
<span class="sd">        timestamp         datetime64[ns]</span>
<span class="sd">        dayOfWeek                  int64</span>
<span class="sd">        dtype: object</span>
<span class="sd">        &gt;&gt;&gt; df = df.select_dtypes(include=[np.number, &#39;datetime&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.dtypes</span>
<span class="sd">        AvgTicketPrice           float64</span>
<span class="sd">        timestamp         datetime64[ns]</span>
<span class="sd">        dayOfWeek                  int64</span>
<span class="sd">        dtype: object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">empty_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_empty_pd_df</span><span class="p">()</span>

        <span class="n">empty_df</span> <span class="o">=</span> <span class="n">empty_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_array</span><span class="p">(</span><span class="n">empty_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a tuple representing the dimensionality of the DataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        shape: tuple</span>

<span class="sd">        0. number of rows</span>
<span class="sd">        1. number of columns</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - number of rows ``len(df)`` queries OpenSearch</span>
<span class="sd">        - number of columns ``len(df.columns)`` is cached. If mappings are updated, DataFrame must be updated.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;ecommerce&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (4675, 45)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">num_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">num_rows</span><span class="p">,</span> <span class="n">num_columns</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns 2 by definition of a DataFrame</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            By definition 2</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.ndim`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">2</span>

<div class="viewcode-block" id="DataFrame.keys">
<a class="viewcode-back" href="../../reference/api/DataFrame.keys.html#opensearch_py_ml.DataFrame.keys">[docs]</a>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return columns</span>

<span class="sd">        See :pandas_api_docs:`pandas.DataFrame.keys`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Index</span>
<span class="sd">            OpenSearch field names as pandas.Index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span></div>


<div class="viewcode-block" id="DataFrame.iterrows">
<a class="viewcode-back" href="../../reference/api/DataFrame.iterrows.html#opensearch_py_ml.DataFrame.iterrows">[docs]</a>
    <span class="k">def</span> <span class="nf">iterrows</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">sort_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;_doc&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over opensearch_py_ml.DataFrame rows as (index, pandas.Series) pairs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sort_index: str, default &#39;_doc&#39;</span>
<span class="sd">            What field to sort the OpenSearch data by.</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        index: index</span>
<span class="sd">            The index of the row.</span>
<span class="sd">        data: pandas Series</span>
<span class="sd">            The data of the row as a pandas Series.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        opensearch_py_ml.DataFrame.itertuples: Iterate over opensearch_py_ml.DataFrame rows as namedtuples.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;]).head()</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           AvgTicketPrice  Cancelled</span>
<span class="sd">        0      841.265642      False</span>
<span class="sd">        1      882.982662      False</span>
<span class="sd">        2      190.636904      False</span>
<span class="sd">        3      181.694216       True</span>
<span class="sd">        4      730.041778      False</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [5 rows x 2 columns]</span>

<span class="sd">        &gt;&gt;&gt; for index, row in df.iterrows():</span>
<span class="sd">        ...     print(row)</span>
<span class="sd">        AvgTicketPrice    841.265642</span>
<span class="sd">        Cancelled              False</span>
<span class="sd">        Name: 0, dtype: object</span>
<span class="sd">        AvgTicketPrice    882.982662</span>
<span class="sd">        Cancelled              False</span>
<span class="sd">        Name: 1, dtype: object</span>
<span class="sd">        AvgTicketPrice    190.636904</span>
<span class="sd">        Cancelled              False</span>
<span class="sd">        Name: 2, dtype: object</span>
<span class="sd">        AvgTicketPrice    181.694216</span>
<span class="sd">        Cancelled               True</span>
<span class="sd">        Name: 3, dtype: object</span>
<span class="sd">        AvgTicketPrice    730.041778</span>
<span class="sd">        Cancelled              False</span>
<span class="sd">        Name: 4, dtype: object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">search_yield_pandas_dataframes</span><span class="p">(</span>
            <span class="n">sort_index</span><span class="o">=</span><span class="n">sort_index</span>
        <span class="p">):</span>
            <span class="k">yield from</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span></div>


<div class="viewcode-block" id="DataFrame.itertuples">
<a class="viewcode-back" href="../../reference/api/DataFrame.itertuples.html#opensearch_py_ml.DataFrame.itertuples">[docs]</a>
    <span class="k">def</span> <span class="nf">itertuples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;opensearch_py_ml&quot;</span><span class="p">,</span>
        <span class="n">sort_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;_doc&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over opensearch_py_ml.DataFrame rows as namedtuples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index: bool, default True</span>
<span class="sd">            If True, return the index as the first element of the tuple.</span>
<span class="sd">        name: str or None, default &quot;opensearch-py-ml&quot;</span>
<span class="sd">            The name of the returned namedtuples or None to return regular tuples.</span>
<span class="sd">        sort_index: str, default &#39;_doc&#39;</span>
<span class="sd">            What field to sort the OpenSearch data by.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        iterator</span>
<span class="sd">            An object to iterate over namedtuples for each row in the</span>
<span class="sd">            DataFrame with the first field possibly being the index and</span>
<span class="sd">            following fields being the column values.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        opensearch_py_ml.DataFrame.iterrows: Iterate over opensearch_py_ml.DataFrame rows as (index, pandas.Series) pairs.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&#39;AvgTicketPrice&#39;, &#39;Cancelled&#39;]).head()</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           AvgTicketPrice  Cancelled</span>
<span class="sd">        0      841.265642      False</span>
<span class="sd">        1      882.982662      False</span>
<span class="sd">        2      190.636904      False</span>
<span class="sd">        3      181.694216       True</span>
<span class="sd">        4      730.041778      False</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [5 rows x 2 columns]</span>

<span class="sd">        &gt;&gt;&gt; for row in df.itertuples():</span>
<span class="sd">        ...     print(row)</span>
<span class="sd">        opensearch_py_ml(Index=&#39;0&#39;, AvgTicketPrice=841.2656419677076, Cancelled=False)</span>
<span class="sd">        opensearch_py_ml(Index=&#39;1&#39;, AvgTicketPrice=882.9826615595518, Cancelled=False)</span>
<span class="sd">        opensearch_py_ml(Index=&#39;2&#39;, AvgTicketPrice=190.6369038508356, Cancelled=False)</span>
<span class="sd">        opensearch_py_ml(Index=&#39;3&#39;, AvgTicketPrice=181.69421554118, Cancelled=True)</span>
<span class="sd">        opensearch_py_ml(Index=&#39;4&#39;, AvgTicketPrice=730.041778346198, Cancelled=False)</span>

<span class="sd">        By setting the `index` parameter to False we can remove the index as the first element of the tuple:</span>

<span class="sd">        &gt;&gt;&gt; for row in df.itertuples(index=False):</span>
<span class="sd">        ...     print(row)</span>
<span class="sd">        opensearch_py_ml(AvgTicketPrice=841.2656419677076, Cancelled=False)</span>
<span class="sd">        opensearch_py_ml(AvgTicketPrice=882.9826615595518, Cancelled=False)</span>
<span class="sd">        opensearch_py_ml(AvgTicketPrice=190.6369038508356, Cancelled=False)</span>
<span class="sd">        opensearch_py_ml(AvgTicketPrice=181.69421554118, Cancelled=True)</span>
<span class="sd">        opensearch_py_ml(AvgTicketPrice=730.041778346198, Cancelled=False)</span>

<span class="sd">        With the `name` parameter set we set a custom name for the yielded namedtuples:</span>

<span class="sd">        &gt;&gt;&gt; for row in df.itertuples(name=&#39;Flight&#39;):</span>
<span class="sd">        ...     print(row)</span>
<span class="sd">        Flight(Index=&#39;0&#39;, AvgTicketPrice=841.2656419677076, Cancelled=False)</span>
<span class="sd">        Flight(Index=&#39;1&#39;, AvgTicketPrice=882.9826615595518, Cancelled=False)</span>
<span class="sd">        Flight(Index=&#39;2&#39;, AvgTicketPrice=190.6369038508356, Cancelled=False)</span>
<span class="sd">        Flight(Index=&#39;3&#39;, AvgTicketPrice=181.69421554118, Cancelled=True)</span>
<span class="sd">        Flight(Index=&#39;4&#39;, AvgTicketPrice=730.041778346198, Cancelled=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">search_yield_pandas_dataframes</span><span class="p">(</span>
            <span class="n">sort_index</span><span class="o">=</span><span class="n">sort_index</span>
        <span class="p">):</span>
            <span class="k">yield from</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.aggregate">
<a class="viewcode-back" href="../../reference/api/DataFrame.aggregate.html#opensearch_py_ml.DataFrame.aggregate">[docs]</a>
    <span class="k">def</span> <span class="nf">aggregate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">func</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">numeric_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate using one or more operations over the specified axis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        func: function, str, list or dict</span>
<span class="sd">            Function to use for aggregating the data. If a function, must either</span>
<span class="sd">            work when passed a %(klass)s or when passed to %(klass)s.apply.</span>

<span class="sd">            Accepted combinations are:</span>

<span class="sd">            - function</span>
<span class="sd">            - string function name</span>
<span class="sd">            - list of functions and/or function names, e.g. ``[np.sum, &#39;mean&#39;]``</span>
<span class="sd">            - dict of axis labels -&gt; functions, function names or list of such.</span>

<span class="sd">            Currently, we only support ``[&#39;count&#39;, &#39;mad&#39;, &#39;max&#39;, &#39;mean&#39;, &#39;median&#39;, &#39;min&#39;, &#39;mode&#39;, &#39;quantile&#39;,</span>
<span class="sd">            &#39;rank&#39;, &#39;sem&#39;, &#39;skew&#39;, &#39;sum&#39;, &#39;std&#39;, &#39;var&#39;]``</span>
<span class="sd">        axis: int</span>
<span class="sd">            Currently, we only support axis=0 (index)</span>
<span class="sd">        numeric_only: {True, False, None} Default is None</span>
<span class="sd">            Which datatype to be returned</span>
<span class="sd">            - True: returns all values with float64, NaN/NaT are ignored.</span>
<span class="sd">            - False: returns all values with float64.</span>
<span class="sd">            - None: returns all values with default datatype.</span>
<span class="sd">        *args</span>
<span class="sd">            Positional arguments to pass to `func`</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Keyword arguments to pass to `func`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame, Series or scalar</span>
<span class="sd">            if DataFrame.agg is called with a single function, returns a Series</span>
<span class="sd">            if DataFrame.agg is called with several functions, returns a DataFrame</span>
<span class="sd">            if Series.agg is called with single function, returns a scalar</span>
<span class="sd">            if Series.agg is called with several functions, returns a Series</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.aggregate`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&#39;AvgTicketPrice&#39;, &#39;DistanceKilometers&#39;, &#39;timestamp&#39;, &#39;DestCountry&#39;])</span>
<span class="sd">        &gt;&gt;&gt; df.aggregate([&#39;sum&#39;, &#39;min&#39;, &#39;std&#39;], numeric_only=True).astype(int)</span>
<span class="sd">             AvgTicketPrice  DistanceKilometers</span>
<span class="sd">        sum         8204364            92616288</span>
<span class="sd">        min             100                   0</span>
<span class="sd">        std             266                4578</span>

<span class="sd">        &gt;&gt;&gt; df.aggregate([&#39;sum&#39;, &#39;min&#39;, &#39;std&#39;], numeric_only=True)</span>
<span class="sd">             AvgTicketPrice  DistanceKilometers</span>
<span class="sd">        sum    8.204365e+06        9.261629e+07</span>
<span class="sd">        min    1.000205e+02        0.000000e+00</span>
<span class="sd">        std    2.664071e+02        4.578614e+03</span>

<span class="sd">        &gt;&gt;&gt; df.aggregate([&#39;sum&#39;, &#39;min&#39;, &#39;std&#39;], numeric_only=False)</span>
<span class="sd">             AvgTicketPrice  DistanceKilometers  timestamp  DestCountry</span>
<span class="sd">        sum    8.204365e+06        9.261629e+07        NaT          NaN</span>
<span class="sd">        min    1.000205e+02        0.000000e+00 2018-01-01          NaN</span>
<span class="sd">        std    2.664071e+02        4.578614e+03        NaT          NaN</span>

<span class="sd">        &gt;&gt;&gt; df.aggregate([&#39;sum&#39;, &#39;min&#39;, &#39;std&#39;], numeric_only=None)</span>
<span class="sd">             AvgTicketPrice  DistanceKilometers  timestamp  DestCountry</span>
<span class="sd">        sum    8.204365e+06        9.261629e+07        NaT          NaN</span>
<span class="sd">        min    1.000205e+02        0.000000e+00 2018-01-01          NaN</span>
<span class="sd">        std    2.664071e+02        4.578614e+03        NaT          NaN</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">_get_axis_number</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Aggregating via index not currently implemented - needs index transform&quot;</span>
            <span class="p">)</span>

        <span class="c1"># currently we only support a subset of functions that aggregate columns.</span>
        <span class="c1"># [&#39;count&#39;, &#39;mad&#39;, &#39;max&#39;, &#39;mean&#39;, &#39;median&#39;, &#39;min&#39;, &#39;mode&#39;, &#39;quantile&#39;,</span>
        <span class="c1"># &#39;rank&#39;, &#39;sem&#39;, &#39;skew&#39;, &#39;sum&#39;, &#39;std&#39;, &#39;var&#39;, &#39;nunique&#39;]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># Wrap in list</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">aggs</span><span class="p">([</span><span class="n">func</span><span class="p">],</span> <span class="n">numeric_only</span><span class="o">=</span><span class="n">numeric_only</span><span class="p">)</span>
                <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_list_like</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="c1"># we have a list!</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">aggs</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="n">numeric_only</span><span class="p">)</span></div>


    <span class="n">agg</span> <span class="o">=</span> <span class="n">aggregate</span>

    <span class="n">hist</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">oml_hist_frame</span>

<div class="viewcode-block" id="DataFrame.groupby">
<a class="viewcode-back" href="../../reference/api/DataFrame.groupby.html#opensearch_py_ml.DataFrame.groupby">[docs]</a>
    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dropna</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrameGroupBy&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to perform groupby operations</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        by:</span>
<span class="sd">            column or list of columns used to groupby</span>
<span class="sd">            Currently accepts column or list of columns</span>

<span class="sd">        dropna: default True</span>
<span class="sd">            If True, and if group keys contain NA values, NA values together with row/column will be dropped.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.groupby.DataFrameGroupBy</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.groupby`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; oml_flights = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&quot;AvgTicketPrice&quot;, &quot;Cancelled&quot;, &quot;dayOfWeek&quot;, &quot;timestamp&quot;, &quot;DestCountry&quot;])</span>
<span class="sd">        &gt;&gt;&gt; oml_flights.groupby([&quot;DestCountry&quot;, &quot;Cancelled&quot;]).agg([&quot;min&quot;, &quot;max&quot;], numeric_only=True) # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">                              AvgTicketPrice              dayOfWeek</span>
<span class="sd">                                         min          max       min  max</span>
<span class="sd">        DestCountry Cancelled</span>
<span class="sd">        AE          False         110.799911  1126.148682       0.0  6.0</span>
<span class="sd">                    True          132.443756   817.931030       0.0  6.0</span>
<span class="sd">        AR          False         125.589394  1199.642822       0.0  6.0</span>
<span class="sd">                    True          251.389603  1172.382568       0.0  6.0</span>
<span class="sd">        AT          False         100.020531  1181.835815       0.0  6.0</span>
<span class="sd">        ...                              ...          ...       ...  ...</span>
<span class="sd">        TR          True          307.915649   307.915649       0.0  0.0</span>
<span class="sd">        US          False         100.145966  1199.729004       0.0  6.0</span>
<span class="sd">                    True          102.153069  1192.429932       0.0  6.0</span>
<span class="sd">        ZA          False         102.002663  1196.186157       0.0  6.0</span>
<span class="sd">                    True          121.280296  1175.709961       0.0  6.0</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [63 rows x 4 columns]</span>

<span class="sd">        &gt;&gt;&gt; oml_flights.groupby([&quot;DestCountry&quot;, &quot;Cancelled&quot;]).mean(numeric_only=True) # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">                               AvgTicketPrice  dayOfWeek</span>
<span class="sd">        DestCountry Cancelled</span>
<span class="sd">        AE          False          643.956793   2.717949</span>
<span class="sd">                    True           388.828809   2.571429</span>
<span class="sd">        AR          False          673.551677   2.746154</span>
<span class="sd">                    True           682.197241   2.733333</span>
<span class="sd">        AT          False          647.158290   2.819936</span>
<span class="sd">        ...                               ...        ...</span>
<span class="sd">        TR          True           307.915649   0.000000</span>
<span class="sd">        US          False          598.063146   2.752014</span>
<span class="sd">                    True           579.799066   2.767068</span>
<span class="sd">        ZA          False          636.998605   2.738589</span>
<span class="sd">                    True           677.794078   2.928571</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [63 rows x 2 columns]</span>

<span class="sd">        &gt;&gt;&gt; oml_flights.groupby([&quot;DestCountry&quot;, &quot;Cancelled&quot;]).min(numeric_only=False) # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">                               AvgTicketPrice  dayOfWeek           timestamp</span>
<span class="sd">        DestCountry Cancelled</span>
<span class="sd">        AE          False          110.799911          0 2018-01-01 19:31:30</span>
<span class="sd">                    True           132.443756          0 2018-01-06 13:03:25</span>
<span class="sd">        AR          False          125.589394          0 2018-01-01 01:30:47</span>
<span class="sd">                    True           251.389603          0 2018-01-01 02:13:17</span>
<span class="sd">        AT          False          100.020531          0 2018-01-01 05:24:19</span>
<span class="sd">        ...                               ...        ...                 ...</span>
<span class="sd">        TR          True           307.915649          0 2018-01-08 04:35:10</span>
<span class="sd">        US          False          100.145966          0 2018-01-01 00:06:27</span>
<span class="sd">                    True           102.153069          0 2018-01-01 09:02:36</span>
<span class="sd">        ZA          False          102.002663          0 2018-01-01 06:44:44</span>
<span class="sd">                    True           121.280296          0 2018-01-04 00:37:01</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [63 rows x 3 columns]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">by</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;by parameter should be specified to groupby&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">by</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">remaining_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">by</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">remaining_columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Requested columns </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">remaining_columns</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> not in the DataFrame&quot;</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">DataFrameGroupBy</span><span class="p">(</span>
            <span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span> <span class="n">query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">dropna</span><span class="o">=</span><span class="n">dropna</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.mode">
<a class="viewcode-back" href="../../reference/api/DataFrame.mode.html#opensearch_py_ml.DataFrame.mode">[docs]</a>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">numeric_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dropna</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">os_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate mode of a DataFrame</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        numeric_only: {True, False} Default is False</span>
<span class="sd">            Which datatype to be returned</span>
<span class="sd">            - True: Returns all numeric or timestamp columns</span>
<span class="sd">            - False: Returns all columns</span>
<span class="sd">        dropna: {True, False} Default is True</span>
<span class="sd">            - True: Don’t consider counts of NaN/NaT.</span>
<span class="sd">            - False: Consider counts of NaN/NaT.</span>
<span class="sd">        os_size: default 10</span>
<span class="sd">            number of rows to be returned if mode has multiple values</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.mode`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; oml_ecommerce = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;ecommerce&#39;)</span>
<span class="sd">        &gt;&gt;&gt; oml_df = oml_ecommerce.filter([&quot;total_quantity&quot;, &quot;geoip.city_name&quot;, &quot;customer_birth_date&quot;, &quot;day_of_week&quot;, &quot;taxful_total_price&quot;])</span>
<span class="sd">        &gt;&gt;&gt; oml_df.mode(numeric_only=False)</span>
<span class="sd">           total_quantity geoip.city_name customer_birth_date day_of_week  taxful_total_price</span>
<span class="sd">        0               2        New York                 NaT    Thursday               53.98</span>

<span class="sd">        &gt;&gt;&gt; oml_df.mode(numeric_only=True)</span>
<span class="sd">           total_quantity  taxful_total_price</span>
<span class="sd">        0               2               53.98</span>

<span class="sd">        &gt;&gt;&gt; oml_df = oml_ecommerce.filter([&quot;products.tax_amount&quot;,&quot;order_date&quot;])</span>
<span class="sd">        &gt;&gt;&gt; oml_df.mode()</span>
<span class="sd">           products.tax_amount          order_date</span>
<span class="sd">        0                  0.0 2016-12-02 20:36:58</span>
<span class="sd">        1                  NaN 2016-12-04 23:44:10</span>
<span class="sd">        2                  NaN 2016-12-08 06:21:36</span>
<span class="sd">        3                  NaN 2016-12-08 09:38:53</span>
<span class="sd">        4                  NaN 2016-12-12 11:38:24</span>
<span class="sd">        5                  NaN 2016-12-12 19:46:34</span>
<span class="sd">        6                  NaN 2016-12-14 18:00:00</span>
<span class="sd">        7                  NaN 2016-12-15 11:38:24</span>
<span class="sd">        8                  NaN 2016-12-22 19:39:22</span>
<span class="sd">        9                  NaN 2016-12-24 06:21:36</span>

<span class="sd">        &gt;&gt;&gt; oml_df.mode(os_size = 3)</span>
<span class="sd">           products.tax_amount          order_date</span>
<span class="sd">        0                  0.0 2016-12-02 20:36:58</span>
<span class="sd">        1                  NaN 2016-12-04 23:44:10</span>
<span class="sd">        2                  NaN 2016-12-08 06:21:36</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO dropna=False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span>
            <span class="n">numeric_only</span><span class="o">=</span><span class="n">numeric_only</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">os_size</span><span class="o">=</span><span class="n">os_size</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.quantile">
<a class="viewcode-back" href="../../reference/api/DataFrame.quantile.html#opensearch_py_ml.DataFrame.quantile">[docs]</a>
    <span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">q</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">numeric_only</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;pd.DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to calculate quantile for a given DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q:</span>
<span class="sd">            float or array like, default 0.5</span>
<span class="sd">            Value between 0 &lt;= q &lt;= 1, the quantile(s) to compute.</span>
<span class="sd">        numeric_only: {True, False, None} Default is True</span>
<span class="sd">            Which datatype to be returned</span>
<span class="sd">            - True: Returns all values as float64, NaN/NaT values are removed</span>
<span class="sd">            - None: Returns all values as the same dtype where possible, NaN/NaT are removed</span>
<span class="sd">            - False: Returns all values as the same dtype where possible, NaN/NaT are preserved</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">            quantile value for each column</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.quantile`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; oml_df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; oml_flights = oml_df.filter([&quot;AvgTicketPrice&quot;, &quot;FlightDelayMin&quot;, &quot;dayOfWeek&quot;, &quot;timestamp&quot;])</span>
<span class="sd">        &gt;&gt;&gt; oml_flights.quantile() # doctest: +SKIP</span>
<span class="sd">        AvgTicketPrice    640.387285</span>
<span class="sd">        FlightDelayMin      0.000000</span>
<span class="sd">        dayOfWeek           3.000000</span>
<span class="sd">        Name: 0.5, dtype: float64</span>

<span class="sd">        &gt;&gt;&gt; oml_flights.quantile([.2, .5, .75]) # doctest: +SKIP</span>
<span class="sd">              AvgTicketPrice  FlightDelayMin  dayOfWeek</span>
<span class="sd">        0.20      361.040768             0.0        1.0</span>
<span class="sd">        0.50      640.387285             0.0        3.0</span>
<span class="sd">        0.75      842.213490            15.0        4.0</span>

<span class="sd">        &gt;&gt;&gt; oml_flights.quantile([.2, .5, .75], numeric_only=False) # doctest: +SKIP</span>
<span class="sd">              AvgTicketPrice  FlightDelayMin  dayOfWeek                     timestamp</span>
<span class="sd">        0.20      361.040768             0.0        1.0 2018-01-09 04:43:55.296587520</span>
<span class="sd">        0.50      640.387285             0.0        3.0 2018-01-21 23:51:57.637076736</span>
<span class="sd">        0.75      842.213490            15.0        4.0 2018-02-01 04:46:16.658119680</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">quantiles</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="n">numeric_only</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.idxmax">
<a class="viewcode-back" href="../../reference/api/DataFrame.idxmax.html#opensearch_py_ml.DataFrame.idxmax">[docs]</a>
    <span class="k">def</span> <span class="nf">idxmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return index of first occurrence of maximum over requested axis.</span>

<span class="sd">        NA/null values are excluded.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : {0, 1}, default 0</span>
<span class="sd">            The axis to filter on, expressed as index (int).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.idxmax`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; oml_df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; oml_flights = oml_df.filter([&quot;AvgTicketPrice&quot;, &quot;FlightDelayMin&quot;, &quot;dayOfWeek&quot;, &quot;timestamp&quot;])</span>
<span class="sd">        &gt;&gt;&gt; oml_flights.idxmax()</span>
<span class="sd">        AvgTicketPrice    1843</span>
<span class="sd">        FlightDelayMin     109</span>
<span class="sd">        dayOfWeek         1988</span>
<span class="sd">        dtype: object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">idx</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="s2">&quot;desc&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.idxmin">
<a class="viewcode-back" href="../../reference/api/DataFrame.idxmin.html#opensearch_py_ml.DataFrame.idxmin">[docs]</a>
    <span class="k">def</span> <span class="nf">idxmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return index of first occurrence of minimum over requested axis.</span>

<span class="sd">        NA/null values are excluded.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : {0, 1}, default 0</span>
<span class="sd">            The axis to filter on, expressed as index (int).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.idxmin`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; oml_df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; oml_flights = oml_df.filter([&quot;AvgTicketPrice&quot;, &quot;FlightDelayMin&quot;, &quot;dayOfWeek&quot;, &quot;timestamp&quot;])</span>
<span class="sd">        &gt;&gt;&gt; oml_flights.idxmin()</span>
<span class="sd">        AvgTicketPrice    5454</span>
<span class="sd">        FlightDelayMin       0</span>
<span class="sd">        dayOfWeek            0</span>
<span class="sd">        dtype: object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">idx</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">sort_order</span><span class="o">=</span><span class="s2">&quot;asc&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataFrame.query">
<a class="viewcode-back" href="../../reference/api/DataFrame.query.html#opensearch_py_ml.DataFrame.query">[docs]</a>
    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the columns of a DataFrame with a boolean expression.</span>

<span class="sd">        TODO - add additional pandas arguments</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        expr: str</span>
<span class="sd">            A boolean expression</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame:</span>
<span class="sd">            DataFrame populated by results of the query</span>

<span class="sd">        TODO - add link to opensearch_py_ml user guide</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.query`</span>
<span class="sd">        :pandas_user_guide:`indexing`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (13059, 27)</span>
<span class="sd">        &gt;&gt;&gt; df.query(&#39;FlightDelayMin &gt; 60&#39;).shape</span>
<span class="sd">        (2730, 27)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">BooleanFilter</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_update_query</span><span class="p">(</span><span class="n">BooleanFilter</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">column_resolver</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">column_resolver</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="c1"># Create fake resolvers - index resolver is empty</span>
            <span class="n">resolvers</span> <span class="o">=</span> <span class="n">column_resolver</span><span class="p">,</span> <span class="p">{}</span>
            <span class="c1"># Use pandas eval to parse query - TODO validate this further</span>
            <span class="nb">filter</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">resolvers</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">resolvers</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">_query_compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">_update_query</span><span class="p">(</span><span class="nb">filter</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span></div>


<div class="viewcode-block" id="DataFrame.get">
<a class="viewcode-back" href="../../reference/api/DataFrame.get.html#opensearch_py_ml.DataFrame.get">[docs]</a>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get item from object for given key (ex: DataFrame column).</span>
<span class="sd">        Returns default value if not found.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key: object</span>
<span class="sd">        default: default value if not found</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        value: same type as items contained in object</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.get`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df.get(&#39;Carrier&#39;)</span>
<span class="sd">        0         Kibana Airlines</span>
<span class="sd">        1        Logstash Airways</span>
<span class="sd">        2        Logstash Airways</span>
<span class="sd">        3         Kibana Airlines</span>
<span class="sd">        4         Kibana Airlines</span>
<span class="sd">                       ...</span>
<span class="sd">        13054    Logstash Airways</span>
<span class="sd">        13055    Logstash Airways</span>
<span class="sd">        13056    Logstash Airways</span>
<span class="sd">        13057            JetBeats</span>
<span class="sd">        13058            JetBeats</span>
<span class="sd">        Name: Carrier, Length: 13059, dtype: object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span></div>


<div class="viewcode-block" id="DataFrame.filter">
<a class="viewcode-back" href="../../reference/api/DataFrame.filter.html#opensearch_py_ml.DataFrame.filter">[docs]</a>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">like</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subset the dataframe rows or columns according to the specified index labels.</span>
<span class="sd">        Note that this routine does not filter a dataframe on its</span>
<span class="sd">        contents. The filter is applied to the labels of the index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        items : list-like</span>
<span class="sd">            Keep labels from axis which are in items.</span>
<span class="sd">        like : str</span>
<span class="sd">            Keep labels from axis for which &quot;like in label == True&quot;.</span>
<span class="sd">        regex : str (regular expression)</span>
<span class="sd">            Keep labels from axis for which re.search(regex, label) == True.</span>
<span class="sd">        axis : {0 or ‘index’, 1 or ‘columns’, None}, default None</span>
<span class="sd">            The axis to filter on, expressed either as an index (int) or axis name (str). By default this is the info axis, ‘index’ for Series, ‘columns’ for DataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opensearch_py_ml.DataFrame</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.filter`</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The ``items``, ``like``, and ``regex`` parameters are</span>
<span class="sd">        enforced to be mutually exclusive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filter_options_passed</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">like</span><span class="p">),</span> <span class="nb">bool</span><span class="p">(</span><span class="n">regex</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">filter_options_passed</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Keyword arguments `items`, `like`, or `regex` &quot;</span>
                <span class="s2">&quot;are mutually exclusive&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">filter_options_passed</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Must pass either &#39;items&#39;, &#39;like&#39;, or &#39;regex&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># axis defaults to &#39;columns&#39; for DataFrame, &#39;index&#39; for Series</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;columns&quot;</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">_get_axis_name</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
            <span class="n">new_query_compiler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_compiler</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="n">regex</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_or_update_from_compiler</span><span class="p">(</span>
                <span class="n">new_query_compiler</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis == &quot;columns&quot;</span>
            <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Pandas skips over columns that don&#39;t exist</span>
                <span class="c1"># and maintains order of items=[...]</span>
                <span class="n">existing_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">existing_columns</span><span class="p">]]</span>

            <span class="k">elif</span> <span class="n">like</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">def</span> <span class="nf">matcher</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">like</span> <span class="ow">in</span> <span class="n">x</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">matcher</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span><span class="o">.</span><span class="n">search</span>

            <span class="k">return</span> <span class="bp">self</span><span class="p">[[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">matcher</span><span class="p">(</span><span class="n">column</span><span class="p">)]]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not implemented.</span>

<span class="sd">        In pandas this returns a Numpy representation of the DataFrame. This would involve scan/scrolling the</span>
<span class="sd">        entire index.</span>

<span class="sd">        If this is required, call ``oml.opensearch_to_pandas(oml_df).values``, *but beware this will scan/scroll the entire</span>
<span class="sd">        OpenSearch index(s) into memory.*</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.values`</span>
<span class="sd">        opensearch_to_pandas</span>
<span class="sd">        to_numpy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<div class="viewcode-block" id="DataFrame.to_numpy">
<a class="viewcode-back" href="../../reference/api/DataFrame.to_numpy.html#opensearch_py_ml.DataFrame.to_numpy">[docs]</a>
    <span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not implemented.</span>

<span class="sd">        In pandas this returns a Numpy representation of the DataFrame. This would involve scan/scrolling the</span>
<span class="sd">        entire index.</span>

<span class="sd">        If this is required, call ``oml.opensearch_to_pandas(oml_df).values``, *but beware this will scan/scroll the</span>
<span class="sd">        entire OpenSearch index(s) into memory.*</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :pandas_api_docs:`pandas.DataFrame.to_numpy`</span>
<span class="sd">        opensearch_to_pandas</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tests import OPENSEARCH_TEST_CLIENT</span>

<span class="sd">        &gt;&gt;&gt; oml_df = oml.DataFrame(OPENSEARCH_TEST_CLIENT, &#39;flights&#39;, columns=[&#39;AvgTicketPrice&#39;, &#39;Carrier&#39;]).head(5)</span>
<span class="sd">        &gt;&gt;&gt; pd_df = oml.opensearch_to_pandas(oml_df)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;type(oml_df)={type(oml_df)}\\ntype(pd_df)={type(pd_df)}&quot;)</span>
<span class="sd">        type(oml_df)=&lt;class &#39;opensearch_py_ml.dataframe.DataFrame&#39;&gt;</span>
<span class="sd">        type(pd_df)=&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="sd">        &gt;&gt;&gt; oml_df</span>
<span class="sd">           AvgTicketPrice           Carrier</span>
<span class="sd">        0      841.265642   Kibana Airlines</span>
<span class="sd">        1      882.982662  Logstash Airways</span>
<span class="sd">        2      190.636904  Logstash Airways</span>
<span class="sd">        3      181.694216   Kibana Airlines</span>
<span class="sd">        4      730.041778   Kibana Airlines</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [5 rows x 2 columns]</span>
<span class="sd">        &gt;&gt;&gt; pd_df.values</span>
<span class="sd">        array([[841.2656419677076, &#39;Kibana Airlines&#39;],</span>
<span class="sd">               [882.9826615595518, &#39;Logstash Airways&#39;],</span>
<span class="sd">               [190.6369038508356, &#39;Logstash Airways&#39;],</span>
<span class="sd">               [181.69421554118, &#39;Kibana Airlines&#39;],</span>
<span class="sd">               [730.041778346198, &#39;Kibana Airlines&#39;]], dtype=object)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s2">&quot;This method would scan/scroll the entire OpenSearch index(s) into memory. &quot;</span>
            <span class="s2">&quot;If this is explicitly required, and there is sufficient memory, call `oml.opensearch_to_pandas(oml_df).values`&quot;</span>
        <span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Opensearch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>